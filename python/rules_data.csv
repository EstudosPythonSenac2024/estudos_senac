name,language,integration,technology,tags,threat_names
Web Application Suspicious Activity: POST Request Declined,kuery,apm,rules/apm,Data Source: APM,N/A
Web Application Suspicious Activity: Unauthorized Method,kuery,apm,rules/apm,Data Source: APM,N/A
Web Application Suspicious Activity: sqlmap User Agent,kuery,apm,rules/apm,Data Source: APM,N/A
Suspicious File Downloaded from Google Drive,eql,"endpoint,system",rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Command and Control,Data Source: System",Command and Control
Potential Non-Standard Port SSH connection,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,OS: macOS,Data Source: Elastic Defend",Command and Control
Potential Cookies Theft via Browser Debugging,eql,"endpoint,windows",rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Active Directory Forced Authentication from Linux Host - SMB Named Pipes,eql,"endpoint,system",rules/cross-platform,"Domain: Endpoint,OS: Windows,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Agent Spoofing - Mismatched Agent ID,kuery,N/A,rules/cross-platform,"Use Case: Threat Detection,Tactic: Defense Evasion",Defense Evasion
Agent Spoofing - Multiple Hosts Using Same Agent,kuery,N/A,rules/cross-platform,"Use Case: Threat Detection,Tactic: Defense Evasion",Defense Evasion
WebServer Access Logs Deleted,eql,"endpoint,windows",rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Tampering of Shell Command-Line History,eql,"endpoint,auditd_manager",rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Defense Evasion
Elastic Agent Service Terminated,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
ROT Encoded Python Script Execution,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Masquerading Space After Filename,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Timestomping using Touch Command,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Security Software Discovery via Grep,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: macOS,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Defend",Discovery
Virtual Machine Fingerprinting via Grep,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: macOS,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
AWS SSM `SendCommand` with Run Shell Command Parameters,kuery,"endpoint,auditd_manager",rules/cross-platform,"Domain: Endpoint,Domain: Cloud,OS: Linux,OS: macOS,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Execution
EggShell Backdoor Execution,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution
Potential Widespread Malware Infection Across Multiple Hosts,esql,N/A,rules/cross-platform,"Domain: Endpoint,Data Source: Elastic Defend,Use Case: Threat Detection,Tactic: Execution,Rule Type: Higher-Order Rule",Execution
Potential Reverse Shell Activity via Terminal,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend",Execution
Deprecated - Suspicious JAVA Child Process,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Use Case: Vulnerability,Data Source: Elastic Defend",Execution
Potential JAVA/JNDI Exploitation Attempt,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Use Case: Vulnerability,Data Source: Elastic Defend",Execution
My First Rule,kuery,N/A,rules/cross-platform,Use Case: Guided Onboarding,N/A
Hosts File Modified,eql,"endpoint,windows",rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: Windows,OS: macOS,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Defend",Impact
Zoom Meeting with no Passcode,kuery,N/A,rules/cross-platform,"Data Source: Zoom,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
Multiple Alerts in Different ATT&CK Tactics on a Single Host,kuery,N/A,rules/cross-platform,"Use Case: Threat Detection,Rule Type: Higher-Order Rule",N/A
Multiple Alerts Involving a User,kuery,N/A,rules/cross-platform,"Use Case: Threat Detection,Rule Type: Higher-Order Rule",N/A
Modification of Standard Authentication Module or Configuration,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: macOS,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Credential Access
Bash Shell Profile Modification,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: macOS,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
SSH Authorized Keys File Modification,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Lateral Movement
Potential Privilege Escalation via Sudoers File Modification,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
SUID/SGID Bit Set,eql,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation; Persistence
Sudoers File Modification,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Sudo Heap-Based Buffer Overflow Attempt,kuery,endpoint,rules/cross-platform,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
AWS EC2 Admin Credential Fetch via Assumed Role,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: Amazon EC2,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Credential Access",Credential Access
AWS IAM Brute Force of Assume Role Policy,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Credential Access",Credential Access
AWS IAM CompromisedKeyQuarantine Policy Attached to User,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Resources: Investigation Guide,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
AWS IAM User Addition to Group,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Identity and Access Audit,Tactic: Credential Access,Tactic: Persistence,Resources: Investigation Guide",Credential Access; Persistence
First Time Seen AWS Secret Value Accessed in Secrets Manager,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Secrets Manager,Tactic: Credential Access,Resources: Investigation Guide",Credential Access
Rapid Secret Retrieval Attempts from AWS SecretsManager,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Secrets Manager,Tactic: Credential Access,Resources: Investigation Guide",Credential Access
AWS Systems Manager SecureString Parameter Request with Decryption Flag,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Systems Manager,Tactic: Credential Access,Resources: Investigation Guide",Credential Access
AWS Management Console Brute Force of Root User Identity,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
AWS CloudTrail Log Suspended,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Log Auditing,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
AWS CloudWatch Alarm Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
AWS Configuration Recorder Stopped,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Tactic: Defense Evasion",Defense Evasion
AWS Config Resource Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
AWS VPC Flow Logs Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Log Auditing,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
AWS EC2 Network Access Control List Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
AWS ElastiCache Security Group Modified or Deleted,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Tactic: Defense Evasion",Defense Evasion
AWS GuardDuty Detector Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Tactic: Defense Evasion",Defense Evasion
Route53 Resolver Query Log Configuration Deleted,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: Amazon Route53,Use Case: Log Auditing,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
AWS S3 Bucket Server Access Logging Disabled,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: Amazon S3,Use Case: Asset Visibility,Tactic: Defense Evasion",Defense Evasion
First Occurrence of STS GetFederationToken Request by User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: Amazon Web Services,Data Source: AWS,Data Source: AWS STS,Use Case: Threat Detection,Tactic: Defense Evasion",Defense Evasion
Insecure AWS EC2 VPC Security Group Ingress Rule Added,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Use Case: Threat Detection,Tactic: Defense Evasion",Defense Evasion
AWS WAF Rule or Rule Group Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
AWS Discovery API Calls via CLI from a Single Resource,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: AWS EC2,Data Source: AWS IAM,Data Source: AWS S3,Use Case: Threat Detection,Tactic: Discovery",Discovery
AWS EC2 Multi-Region DescribeInstances API Calls,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: AWS EC2,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Discovery",Discovery
AWS STS GetCallerIdentity API Called for the First Time,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Use Case: Identity and Access Audit,Tactic: Discovery,Resources: Investigation Guide",Discovery
AWS Service Quotas Multi-Region `GetServiceQuota` Requests,esql,N/A,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Service Quotas,Use Case: Threat Detection,Tactic: Discovery",Discovery
AWS Lambda Layer Added to Existing Function,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Lambda,Use Case: Threat Detection,Tactic: Execution",Execution
First Time AWS Cloudformation Stack Creation by User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: Cloudformation,Use Case: Asset Visibility,Tactic: Execution",Execution
AWS SSM Command Document Created by Rare User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS SNS,Data Source: AWS Systems Manager,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Execution",Execution
AWS SSM `SendCommand` Execution by Rare User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS SSM,Use Case: Log Auditing,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide",Execution
EC2 AMI Shared with Another Account,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS EC2 EBS Snapshot Shared with Another Account,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS EC2 Snapshot Activity,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Asset Visibility,Tactic: Exfiltration,Resources: Investigation Guide",Exfiltration
AWS EC2 VM Export Failure,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Use Case: Asset Visibility,Tactic: Exfiltration,Tactic: Collection",Exfiltration; Collection
AWS RDS DB Snapshot Shared with Another Account,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS S3 Bucket Policy Added to Share with External Account,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS S3 Bucket Replicated to Another Account,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS SNS Email Subscription by Rare User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS SNS,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Exfiltration",Exfiltration
AWS EventBridge Rule Disabled or Deleted,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Tactic: Impact",Impact
AWS S3 Bucket Enumeration or Brute Force,esql,N/A,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Log Auditing,Tactic: Impact",Impact; Discovery; Collection
AWS CloudTrail Log Updated,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Cloudtrail,Use Case: Log Auditing,Resources: Investigation Guide,Tactic: Impact",Impact; Collection
AWS CloudWatch Log Group Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS CloudWatch,Use Case: Log Auditing,Resources: Investigation Guide,Tactic: Impact",Impact; Defense Evasion
AWS CloudWatch Log Stream Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS CloudWatch,Use Case: Log Auditing,Tactic: Impact,Resources: Investigation Guide",Impact; Defense Evasion
AWS IAM Group Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Tactic: Impact",Impact
AWS KMS Customer Managed Key Disabled or Scheduled for Deletion,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS KMS,Use Case: Log Auditing,Tactic: Impact",Impact
AWS Deletion of RDS Instance or Cluster,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Use Case: Asset Visibility,Tactic: Impact",Impact
AWS RDS DB Instance or Cluster Deletion Protection Disabled,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Impact",Impact
AWS RDS Snapshot Deleted,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Use Case: Asset Visibility,Tactic: Impact",Impact
Potential AWS S3 Bucket Ransomware Note Uploaded,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Use Case: Threat Detection,Tactic: Impact",Impact
AWS S3 Object Encryption Using External KMS Key,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Data Source: AWS KMS,Use Case: Threat Detection,Tactic: Impact",Impact
AWS S3 Object Versioning Suspended,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS S3,Use Case: Threat Detection,Tactic: Impact",Impact
AWS Management Console Root Login,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Signin,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Initial Access",Initial Access; Persistence
AWS IAM Password Recovery Requested,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Signin,Use Case: Identity and Access Audit,Tactic: Initial Access",Initial Access
AWS Signin Single Factor Console Login with Federated User,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: Amazon Web Services,Data Source: AWS,Data Source: AWS Sign-In,Use Case: Threat Detection,Tactic: Initial Access",Initial Access
SSM Session Started to EC2 Instance,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS SSM,Use Case: Threat Detection,Tactic: Lateral Movement",Lateral Movement
AWS EC2 Instance Console Login via Assumed Role,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Data Source: AWS STS,Use Case: Identity and Access Audit,Tactic: Lateral Movement,Tactic: Credential Access",Lateral Movement; Credential Access
Spike in AWS Error Messages,N/A,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Rule Type: ML,Rule Type: Machine Learning,Resources: Investigation Guide",N/A
Rare AWS Error Code,N/A,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Rule Type: ML,Rule Type: Machine Learning,Resources: Investigation Guide",N/A
Unusual City For an AWS Command,N/A,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Rule Type: ML,Rule Type: Machine Learning,Resources: Investigation Guide",N/A
Unusual Country For an AWS Command,N/A,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Rule Type: ML,Rule Type: Machine Learning,Resources: Investigation Guide",N/A
Unusual AWS Command for a User,N/A,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Rule Type: ML,Rule Type: Machine Learning,Resources: Investigation Guide",N/A
AWS EC2 Network Access Control List Creation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Use Case: Network Security Monitoring,Tactic: Persistence",Persistence
AWS IAM Login Profile Added for Root,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
AWS IAM Create User via Assumed Role on EC2 Instance,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
AWS IAM Group Creation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
AWS IAM Roles Anywhere Profile Creation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
AWS IAM Roles Anywhere Trust Anchor Created with External CA,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
AWS IAM User Created Access Keys For Another User,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Resources: Investigation Guide",Persistence; Privilege Escalation
AWS Lambda Function Policy Updated to Allow Public Invocation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Lambda,Use Case: Threat Detection,Tactic: Persistence",Persistence
AWS RDS DB Instance or Cluster Password Modified,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Defense Evasion",Persistence; Privilege Escalation; Defense Evasion
AWS RDS Security Group Creation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Tactic: Persistence",Persistence
AWS RDS Instance Creation,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Use Case: Asset Visibility,Tactic: Persistence",Persistence
AWS RDS DB Instance Made Public,eql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Resources: Investigation Guide,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion",Persistence; Defense Evasion
AWS Route 53 Domain Transferred to Another Account,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Route53,Use Case: Asset Visibility,Tactic: Persistence",Persistence; Credential Access
AWS Route 53 Domain Transfer Lock Disabled,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Route53,Use Case: Asset Visibility,Tactic: Persistence",Persistence; Credential Access
AWS Route53 private hosted zone associated with a VPC,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Route53,Use Case: Asset Visibility,Tactic: Persistence",Persistence
AWS STS AssumeRole with New MFA Device,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Tactic: Lateral Movement",Persistence; Privilege Escalation; Lateral Movement
AWS EC2 Instance Connect SSH Public Key Uploaded,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation
AWS IAM AdministratorAccess Policy Attached to Group,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Resources: Investigation Guide",Privilege Escalation; Persistence
AWS IAM AdministratorAccess Policy Attached to Role,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Resources: Investigation Guide",Privilege Escalation; Persistence
AWS IAM AdministratorAccess Policy Attached to User,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Resources: Investigation Guide",Privilege Escalation; Persistence
AWS IAM Customer-Managed Policy Attached to Role by Rare User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Resources: Investigation Guide,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation
AWS IAM SAML Provider Updated,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation
AWS STS Role Assumption by Service,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Resources: Investigation Guide,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation; Lateral Movement
AWS STS Role Assumption by User,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Resources: Investigation Guide,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation; Lateral Movement
AWS Root Login Without MFA,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Route53,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Privilege Escalation",Privilege Escalation
AWS STS AssumeRoot by Rare User and Member Account,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Resources: Investigation Guide,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation; Persistence
AWS STS Role Chaining,esql,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Lateral Movement",Privilege Escalation; Lateral Movement; Persistence
AWS IAM Assume Role Policy Update,kuery,aws,rules/integrations/aws,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS STS,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Privilege Escalation",Privilege Escalation
AWS Bedrock Invocations without Guardrails Detected by a Single User Over a Session,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
AWS Bedrock Guardrails Detected Multiple Violations by a Single User Over a Session,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
AWS Bedrock Guardrails Detected Multiple Policy Violations Within a Single Blocked Request,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
Unusual High Confidence Content Filter Blocks Detected,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
Potential Abuse of Resources by High Token Count and Large Response Sizes,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: Amazon Web Services,Data Source: AWS S3,Use Case: Potential Overload,Use Case: Resource Exhaustion,Mitre Atlas: LLM04",N/A
AWS Bedrock Detected Multiple Attempts to use Denied Models by a Single User,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Resources: Investigation Guide,Use Case: Policy Violation,Mitre Atlas: T0015,Mitre Atlas: T0034",N/A
Unusual High Denied Sensitive Information Policy Blocks Detected,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
Unusual High Denied Topic Blocks Detected,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
AWS Bedrock Detected Multiple Validation Exception Errors by a Single User,esql,aws_bedrock,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS,Data Source: AWS Bedrock,Data Source: AWS S3,Use Case: Policy Violation,Mitre Atlas: T0015,Mitre Atlas: T0034,Mitre Atlas: T0046",N/A
Unusual High Word Policy Blocks Detected,esql,N/A,rules/integrations/aws_bedrock,"Domain: LLM,Data Source: AWS Bedrock,Data Source: AWS S3,Use Case: Policy Violation,Mitre Atlas: T0051,Mitre Atlas: T0054",N/A
Azure Event Hub Authorization Rule Created or Updated,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Log Auditing,Tactic: Collection",Collection; Exfiltration
Azure Entra MFA TOTP Brute Force Attempts,esql,azure,rules/integrations/azure,"Domain: Cloud,Domain: SaaS,Data Source: Azure,Data Source: Entra ID,Data Source: Entra ID Sign-in,Use Case: Identity and Access Audit,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Azure Full Network Packet Capture Detected,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Tactic: Credential Access",Credential Access
Entra ID Device Code Auth with Broker Client,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Data Source: Microsoft Entra ID,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
Azure Entra Sign-in Brute Force against Microsoft 365 Accounts,esql,azure,rules/integrations/azure,"Domain: Cloud,Domain: SaaS,Data Source: Azure,Data Source: Entra ID,Data Source: Entra ID Sign-in,Use Case: Identity and Access Audit,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Azure Entra Sign-in Brute Force Microsoft 365 Accounts by Repeat Source,esql,azure,rules/integrations/azure,"Domain: Cloud,Domain: SaaS,Data Source: Azure,Data Source: Entra ID,Data Source: Entra ID Sign-in,Use Case: Identity and Access Audit,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
First Occurrence of Entra ID Auth via DeviceCode Protocol,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Data Source: Microsoft Entra ID,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
Azure Storage Account Key Regenerated,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
Azure Automation Runbook Deleted,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
Azure Blob Permissions Modification,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Azure Event Hub Deletion,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Log Auditing,Tactic: Defense Evasion",Defense Evasion
Azure Frontdoor Web Application Firewall (WAF) Policy Deleted,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
Azure Kubernetes Events Deleted,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Log Auditing,Tactic: Defense Evasion",Defense Evasion
Azure Alert Suppression Rule Created or Modified,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
Azure Command Execution on Virtual Machine,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Log Auditing,Tactic: Execution",Execution
Azure Service Principal Credentials Added,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Impact",Impact
Azure Kubernetes Pods Deleted,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Asset Visibility,Tactic: Impact",Impact
Azure Virtual Network Device Modified or Deleted,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Network Security Monitoring,Tactic: Impact",Impact
Azure Active Directory High Risk Sign-in,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Initial Access",Initial Access
Azure Active Directory High Risk User Sign-in Heuristic,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Initial Access",Initial Access
Possible Consent Grant Attack via Azure-Registered Application,kuery,"azure,o365",rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Initial Access",Initial Access; Credential Access
Azure Automation Account Created,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence; Defense Evasion
Azure Automation Runbook Created or Modified,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Persistence",N/A
Azure Automation Webhook Created,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Persistence",N/A
Azure Conditional Access Policy Modified,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Persistence",Persistence
Azure AD Global Administrator Role Assigned,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
Azure Privilege Identity Management Role Modified,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Persistence",Persistence; Defense Evasion
Multi-Factor Authentication Disabled for an Azure User,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Persistence",Persistence
User Added as Owner for Azure Application,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Persistence",Persistence
User Added as Owner for Azure Service Principal,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Configuration Audit,Tactic: Persistence",Persistence
Azure Kubernetes Rolebindings Created,kuery,azure,rules/integrations/azure,"Domain: Cloud,Data Source: Azure,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation
Statistical Model Detected C2 Beaconing Activity,kuery,"beaconing,endpoint,network_traffic",rules/integrations/beaconing,"Domain: Network,Use Case: C2 Beaconing Detection,Tactic: Command and Control",Command and Control
Statistical Model Detected C2 Beaconing Activity with High Confidence,kuery,"beaconing,endpoint,network_traffic",rules/integrations/beaconing,"Domain: Network,Use Case: C2 Beaconing Detection,Tactic: Command and Control",Command and Control
Container Workload Protection,kuery,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container",N/A
AWS Credentials Searched For Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Sensitive Files Compression Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Collection,Tactic: Credential Access",Credential Access; Collection
Sensitive Keys Or Passwords Searched For Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Modification of Dynamic Linker Preload Shared Object Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,Tactic: Defense Evasion",Defense Evasion
Suspicious Network Tool Launched Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Tactic: Command and Control,Tactic: Reconnaissance",Discovery; Command and Control; Reconnaissance
Container Management Utility Run Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution
File Made Executable via Chmod Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion",Execution; Defense Evasion
Interactive Exec Command Launched Against A Running Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution
Suspicious Interactive Shell Spawned From Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution
Netcat Listener Established Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution
SSH Connection Established Inside A Running Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Lateral Movement",Initial Access; Lateral Movement
SSH Process Launched From Inside A Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Persistence",Lateral Movement; Persistence
SSH Authorized Keys File Modified Inside a Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Lateral Movement",Persistence; Lateral Movement
File System Debugger Launched Inside a Privileged Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Mount Launched Inside a Privileged Container,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Potential Container Escape via Modified notify_on_release File,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Potential Container Escape via Modified release_agent File,eql,cloud_defend,rules/integrations/cloud_defend,"Data Source: Elastic Defend for Containers,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
CyberArk Privileged Access Security Error,kuery,cyberarkpas,rules/integrations/cyberarkpas,"Data Source: CyberArk PAS,Use Case: Log Auditing,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation; Initial Access
CyberArk Privileged Access Security Recommended Monitor,kuery,cyberarkpas,rules/integrations/cyberarkpas,"Data Source: CyberArk PAS,Use Case: Log Auditing,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation; Initial Access
Potential Data Exfiltration Activity to an Unusual ISO Code,N/A,"ded,endpoint,network_traffic",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Potential Data Exfiltration Activity to an Unusual IP Address,N/A,"ded,endpoint,network_traffic",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Potential Data Exfiltration Activity to an Unusual Destination Port,N/A,"ded,endpoint,network_traffic",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Potential Data Exfiltration Activity to an Unusual Region,N/A,"ded,endpoint,network_traffic",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Spike in Bytes Sent to an External Device,N/A,"ded,endpoint",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Spike in Bytes Sent to an External Device via Airdrop,N/A,"ded,endpoint",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Unusual Process Writing Data to an External Device,N/A,"ded,endpoint",rules/integrations/ded,"Use Case: Data Exfiltration Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Exfiltration",Exfiltration
Machine Learning Detected DGA activity using a known SUNBURST DNS domain,kuery,"dga,endpoint,network_traffic",rules/integrations/dga,"Domain: Network,Domain: Endpoint,Data Source: Elastic Defend,Use Case: Domain Generation Algorithm Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Potential DGA Activity,N/A,"dga,endpoint,network_traffic",rules/integrations/dga,"Use Case: Domain Generation Algorithm Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Machine Learning Detected a DNS Request With a High DGA Probability Score,kuery,"dga,endpoint,network_traffic",rules/integrations/dga,"Domain: Network,Domain: Endpoint,Data Source: Elastic Defend,Use Case: Domain Generation Algorithm Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Machine Learning Detected a DNS Request Predicted to be a DGA Domain,kuery,"dga,endpoint,network_traffic",rules/integrations/dga,"Domain: Network,Domain: Endpoint,Data Source: Elastic Defend,Use Case: Domain Generation Algorithm Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Memory Threat - Detected - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Defense Evasion",Defense Evasion
Memory Threat - Prevented- Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Defense Evasion",Defense Evasion
Endpoint Security (Elastic Defend),kuery,endpoint,rules/integrations/endpoint,Data Source: Elastic Defend,N/A
Behavior - Detected - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,Data Source: Elastic Defend,N/A
Behavior - Prevented - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,Data Source: Elastic Defend,N/A
Malicious File - Detected - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Execution",Execution
Malicious File - Prevented - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Execution",Execution
Ransomware - Detected - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Impact",Impact
Ransomware - Prevented - Elastic Defend,kuery,endpoint,rules/integrations/endpoint,"Data Source: Elastic Defend,Tactic: Impact",Impact
Potential Persistence via File Modification,eql,fim,rules/integrations/fim,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Credential Access,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: File Integrity Monitoring",Persistence; Privilege Escalation; Credential Access; Defense Evasion
GCP Pub/Sub Subscription Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Log Auditing,Tactic: Collection",Collection
GCP Firewall Rule Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Firewall Rule Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Firewall Rule Modification,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Logging Bucket Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Log Auditing,Tactic: Defense Evasion",Defense Evasion
GCP Logging Sink Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Log Auditing,Tactic: Defense Evasion",Defense Evasion
GCP Pub/Sub Subscription Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Log Auditing,Tactic: Defense Evasion",Defense Evasion
GCP Storage Bucket Configuration Modification,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Defense Evasion",Defense Evasion
GCP Storage Bucket Permissions Modification,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Defense Evasion",Defense Evasion
GCP Virtual Private Cloud Network Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Virtual Private Cloud Route Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Virtual Private Cloud Route Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
GCP Logging Sink Modification,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Log Auditing,Tactic: Exfiltration",Exfiltration
GCP Service Account Deletion,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Impact",Impact
GCP Service Account Disabled,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Impact",Impact
GCP IAM Custom Role Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Initial Access",Initial Access; Persistence
GCP Service Account Key Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
GCP Service Account Creation,kuery,gcp,rules/integrations/gcp,"Domain: Cloud,Data Source: GCP,Data Source: Google Cloud Platform,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
GitHub Protected Branch Settings Changed,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Github",Defense Evasion
GitHub App Deleted,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Tactic: Execution,Data Source: Github",Execution
High Number of Cloned GitHub Repos From PAT,kuery,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Data Source: Github",Execution
GitHub UEBA - Multiple Alerts from a GitHub Account,kuery,N/A,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: Higher-Order Rule,Data Source: Github",Execution
New GitHub App Installed,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Tactic: Execution,Data Source: Github",Execution
GitHub Repository Deleted,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Impact,Data Source: Github",Impact
New GitHub Owner Added,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Persistence,Data Source: Github",Persistence
GitHub Owner Role Granted To User,eql,github,rules/integrations/github,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Persistence,Data Source: Github",Persistence
Google Drive Ownership Transferred via Google Workspace,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Tactic: Collection,Resources: Investigation Guide",Collection
Google Workspace Custom Gmail Route Created or Modified,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Tactic: Collection,Resources: Investigation Guide",Collection
Google Workspace Drive Encryption Key(s) Accessed from Anonymous User,eql,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Credential Access",Credential Access
Application Removed from Blocklist in Google Workspace,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Resources: Investigation Guide,Tactic: Defense Evasion",Defense Evasion
Domain Added to Google Workspace Trusted Domains,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Defense Evasion,Resources: Investigation Guide",Defense Evasion
Google Workspace Bitlocker Setting Disabled,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Defense Evasion,Resources: Investigation Guide",Defense Evasion
First Time Seen Google Workspace OAuth Login from Third-Party Application,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Tactic: Defense Evasion,Tactic: Initial Access",Defense Evasion; Initial Access
Google Workspace Restrictions for Marketplace Modified to Allow Any App,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Defense Evasion,Resources: Investigation Guide",Defense Evasion
Forwarded Google Workspace Security Alert,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Log Auditing,Use Case: Threat Detection",N/A
Google Workspace Admin Role Deletion,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Impact,Resources: Investigation Guide",Impact
Google Workspace MFA Enforcement Disabled,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Impact,Resources: Investigation Guide",Impact
External User Added to Google Workspace Group,eql,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Initial Access,Resources: Investigation Guide",Initial Access
Google Workspace Suspended User Account Renewed,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Initial Access",Initial Access
Google Workspace Object Copied to External Drive with App Consent,eql,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Tactic: Initial Access,Resources: Investigation Guide",N/A
Application Added to Google Workspace Domain,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
Google Workspace 2SV Policy Disabled,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
Google Workspace Admin Role Assigned to a User,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
Google Workspace API Access Granted via Domain-Wide Delegation,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Persistence",Persistence
Google Workspace Custom Admin Role Created,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Persistence",Persistence
Google Workspace Password Policy Modified,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
Google Workspace Role Modified,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Resources: Investigation Guide,Tactic: Persistence",Persistence
Google Workspace User Organizational Unit Changed,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Configuration Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
MFA Disabled for Google Workspace Organization,kuery,google_workspace,rules/integrations/google_workspace,"Domain: Cloud,Data Source: Google Workspace,Use Case: Identity and Access Audit,Tactic: Persistence,Resources: Investigation Guide",Persistence
Kubernetes Denied Service Account Request,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Discovery",Discovery
Kubernetes Suspicious Self-Subject Review,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Discovery",Discovery
Kubernetes User Exec into Pod,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution",Execution
Kubernetes Exposed Service Created With Type NodePort,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Persistence",Persistence
Kubernetes Container Created with Excessive Linux Capabilities,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Pod Created With HostIPC,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Pod Created With HostNetwork,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Pod Created With HostPID,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Pod created with a Sensitive hostPath Volume,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Privileged Pod Created,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation; Execution
Kubernetes Suspicious Assignment of Controller Service Account,kuery,kubernetes,rules/integrations/kubernetes,"Data Source: Kubernetes,Tactic: Execution,Tactic: Privilege Escalation",Privilege Escalation
High Mean of Process Arguments in an RDP Session,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
High Mean of RDP Session Duration,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Unusual Remote File Size,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
High Variance in RDP Session Duration,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Unusual Remote File Directory,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Unusual Remote File Extension,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Spike in Number of Connections Made from a Source IP,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Spike in Number of Connections Made to a Destination IP,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Spike in Number of Processes in an RDP Session,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Spike in Remote File Transfers,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Unusual Time or Day for an RDP Session,N/A,"lmd,endpoint",rules/integrations/lmd,"Use Case: Lateral Movement Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Lateral Movement",Lateral Movement
Microsoft 365 Inbox Forwarding Rule Created,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Collection",Collection
Attempts to Brute Force a Microsoft 365 User Account,esql,o365,rules/integrations/o365,"Domain: Cloud,Domain: SaaS,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Deprecated - Potential Password Spraying of Microsoft 365 User Accounts,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
O365 Excessive Single Sign-On Logon Errors,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
Microsoft 365 Exchange DLP Policy Removed,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
Microsoft 365 Exchange Malware Filter Policy Deletion,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
Microsoft 365 Exchange Malware Filter Rule Modification,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
Microsoft 365 Exchange Safe Attachment Rule Disabled,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Defense Evasion",Defense Evasion
O365 Mailbox Audit Logging Bypass,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Tactic: Initial Access,Tactic: Defense Evasion",Defense Evasion
Microsoft 365 Exchange Transport Rule Creation,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Exfiltration",Exfiltration
Microsoft 365 Exchange Transport Rule Modification,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Exfiltration",Exfiltration
Microsoft 365 Mass download by a single user,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Exfiltration",Exfiltration
Microsoft 365 Potential ransomware activity,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Impact",Impact
Microsoft 365 Unusual Volume of File Deletion,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Impact",Impact
Suspicious Microsoft 365 Mail Access by ClientAppId,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
Microsoft 365 Exchange Anti-Phish Policy Deletion,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
Microsoft 365 Exchange Anti-Phish Rule Modification,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
Microsoft 365 Exchange Safe Link Policy Disabled,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Initial Access",Initial Access
Microsoft 365 Impossible travel activity,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
Microsoft 365 Portal Logins from Impossible Travel Locations,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Threat Detection,Tactic: Initial Access",Initial Access
Microsoft 365 Portal Login from Rare Location,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Threat Detection,Tactic: Initial Access",Initial Access
Microsoft 365 User Restricted from Sending Email,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Initial Access",Initial Access
O365 Email Reported by User as Malware or Phish,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Tactic: Initial Access",Initial Access
OneDrive Malware File Upload,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Tactic: Lateral Movement",Lateral Movement
SharePoint Malware File Upload,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Tactic: Lateral Movement",Lateral Movement
O365 Exchange Suspicious Mailbox Right Delegation,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Persistence",Persistence
Microsoft 365 Exchange DKIM Signing Configuration Disabled,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Tactic: Persistence",Persistence
Microsoft 365 Exchange Management Group Role Assignment,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
Microsoft 365 Global Administrator Role Assigned,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
Microsoft 365 Teams Custom Application Interaction Allowed,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Persistence",Persistence
Microsoft 365 Teams External Access Enabled,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Persistence",Persistence
Microsoft 365 Teams Guest Access Enabled,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Configuration Audit,Tactic: Persistence",Persistence
New or Modified Federation Domain,kuery,o365,rules/integrations/o365,"Domain: Cloud,Data Source: Microsoft 365,Use Case: Identity and Access Audit,Tactic: Privilege Escalation",Privilege Escalation
Attempted Bypass of Okta MFA,kuery,okta,rules/integrations/okta,"Data Source: Okta,Use Case: Identity and Access Audit,Tactic: Credential Access",Credential Access
Attempts to Brute Force an Okta User Account,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Credential Access,Data Source: Okta",Credential Access
Multiple Okta User Auth Events with Same Device Token Hash Behind a Proxy,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Credential Access",Credential Access
Multiple Device Token Hashes for Single Okta Session,esql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Credential Access,Domain: SaaS",Credential Access
Multiple Okta User Authentication Events with Client Address,esql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Credential Access",Credential Access
Multiple Okta User Authentication Events with Same Device Token Hash,esql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Credential Access",Credential Access
Okta Brute Force or Password Spraying Attack,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Credential Access,Data Source: Okta",Credential Access
Potential Okta MFA Bombing via Push Notifications,eql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Credential Access,Data Source: Okta",Credential Access
High Number of Okta Device Token Cookies Generated for Authentication,esql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Credential Access",Credential Access
Potentially Successful MFA Bombing via Push Notifications,eql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Credential Access,Data Source: Okta",Credential Access
Okta User Session Impersonation,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Credential Access,Data Source: Okta",Credential Access
Attempt to Deactivate an Okta Network Zone,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
Attempt to Delete an Okta Network Zone,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
Unauthorized Scope for Public App OAuth2 Token Grant with Client Credentials,kuery,okta,rules/integrations/okta,"Domain: SaaS,Data Source: Okta,Use Case: Threat Detection,Use Case: Identity and Access Audit,Tactic: Defense Evasion",Defense Evasion
Attempt to Deactivate an Okta Policy,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Defense Evasion",Defense Evasion
Attempt to Deactivate an Okta Policy Rule,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Defense Evasion,Data Source: Okta",Defense Evasion
Attempt to Delete an Okta Policy,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Defense Evasion",Defense Evasion
Attempt to Delete an Okta Policy Rule,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Defense Evasion",Defense Evasion
Attempt to Modify an Okta Network Zone,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Use Case: Network Security Monitoring,Tactic: Defense Evasion",Defense Evasion
Attempt to Modify an Okta Policy,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Defense Evasion",Defense Evasion
Attempt to Modify an Okta Policy Rule,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Defense Evasion,Data Source: Okta",Defense Evasion
High Number of Okta User Password Reset or Unlock Attempts,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Defense Evasion",Defense Evasion; Persistence; Initial Access
Attempt to Revoke Okta API Token,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Impact",Impact
Attempt to Deactivate an Okta Application,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Impact",Impact
Attempt to Delete an Okta Application,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Impact",Impact
Attempt to Modify an Okta Application,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Impact",Impact
Possible Okta DoS Attack,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Impact",Impact
First Occurrence of Okta User Session Started via Proxy,kuery,okta,rules/integrations/okta,"Tactic: Initial Access,Use Case: Identity and Access Audit,Data Source: Okta",Initial Access
New Okta Authentication Behavior Detected,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Initial Access,Data Source: Okta",Initial Access
Okta FastPass Phishing Detection,kuery,okta,rules/integrations/okta,"Tactic: Initial Access,Use Case: Identity and Access Audit,Data Source: Okta",Initial Access
Unauthorized Access to an Okta Application,kuery,okta,rules/integrations/okta,"Tactic: Initial Access,Use Case: Identity and Access Audit,Data Source: Okta",Initial Access; Defense Evasion; Persistence; Privilege Escalation
Okta User Sessions Started from Different Geolocations,esql,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Initial Access",Initial Access
Okta Sign-In Events via Third-Party IdP,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Initial Access,Data Source: Okta",Initial Access
Successful Application SSO from Rare Unknown Client Device,kuery,okta,rules/integrations/okta,"Domain: SaaS,Data Source: Okta,Use Case: Threat Detection,Use Case: Identity and Access Audit,Tactic: Initial Access",Initial Access
Suspicious Activity Reported by Okta User,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Initial Access",Initial Access; Persistence; Privilege Escalation; Defense Evasion
Multiple Okta Sessions Detected for a Single User,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Lateral Movement",Lateral Movement
Okta ThreatInsight Threat Suspected Promotion,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta",N/A
Administrator Privileges Assigned to an Okta Group,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Persistence",Persistence
Administrator Role Assigned to an Okta User,kuery,okta,rules/integrations/okta,"Data Source: Okta,Use Case: Identity and Access Audit,Tactic: Persistence",Persistence
Attempt to Create Okta API Token,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Data Source: Okta,Tactic: Persistence",Persistence
Attempt to Reset MFA Factors for an Okta User Account,kuery,okta,rules/integrations/okta,"Tactic: Persistence,Use Case: Identity and Access Audit,Data Source: Okta",Persistence
MFA Deactivation with no Re-Activation for Okta User Account,eql,okta,rules/integrations/okta,"Tactic: Persistence,Use Case: Identity and Access Audit,Data Source: Okta,Domain: Cloud",Persistence
New Okta Identity Provider (IdP) Added by Admin,kuery,okta,rules/integrations/okta,"Use Case: Identity and Access Audit,Tactic: Persistence,Data Source: Okta",Persistence
Modification or Removal of an Okta Application Sign-On Policy,kuery,okta,rules/integrations/okta,"Tactic: Persistence,Use Case: Identity and Access Audit,Data Source: Okta",Persistence
Stolen Credentials Used to Login to Okta Account After MFA Reset,eql,"endpoint,okta",rules/integrations/okta,"Tactic: Persistence,Use Case: Identity and Access Audit,Data Source: Okta,Data Source: Elastic Defend,Rule Type: Higher-Order Rule,Domain: Endpoint,Domain: Cloud",Persistence
Unusual Process Spawned by a Host,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Domain: Endpoint,OS: Windows,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Unusual Process Spawned by a Parent Process,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Domain: Endpoint,OS: Windows,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Unusual Process Spawned by a User,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Domain: Endpoint,OS: Windows,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Machine Learning Detected a Suspicious Windows Event with a High Malicious Probability Score,eql,"problemchild,endpoint,windows",rules/integrations/problemchild,"OS: Windows,Data Source: Elastic Endgame,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Machine Learning Detected a Suspicious Windows Event with a Low Malicious Probability Score,eql,"problemchild,endpoint",rules/integrations/problemchild,"OS: Windows,Data Source: Elastic Endgame,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Suspicious Windows Process Cluster Spawned by a Host,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Suspicious Windows Process Cluster Spawned by a Parent Process,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Domain: Endpoint,OS: Windows,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Suspicious Windows Process Cluster Spawned by a User,N/A,"problemchild,endpoint,windows",rules/integrations/problemchild,"Domain: Endpoint,OS: Windows,Use Case: Living off the Land Attack Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Defense Evasion",Defense Evasion
Linux Clipboard Activity Detected,kuery,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Collection,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Collection
AWS CLI Command with Custom Endpoint URL,kuery,endpoint,rules/linux,"Data Source: Elastic Defend,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control",Command and Control
Network Activity Detected via cat,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control; Defense Evasion; Exfiltration
Network Connection by Cups or Foomatic-rip Child,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control; Execution; Defense Evasion; Exfiltration
Curl SOCKS Proxy Activity from Unusual Parent,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control
IPv4/IPv6 Forwarding Activity,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control
Potential Protocol Tunneling via Chisel Client,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control
Potential Protocol Tunneling via Chisel Server,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control
Network Activity Detected via Kworker,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control; Defense Evasion; Exfiltration
ProxyChains Activity,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Command and Control
Linux SSH X11 Forwarding,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Data Source: Elastic Endgame",Command and Control
Suspicious Utility Launched via ProxyChains,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Command and Control
Potential Linux Tunneling and/or Port Forwarding,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Data Source: Elastic Endgame",Command and Control
Suspicious Network Activity to the Internet by Previously Unknown Executable,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend",Command and Control
Potential Protocol Tunneling via EarthWorm,eql,"endpoint,crowdstrike,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Crowdstrike,Data Source: SentinelOne",Command and Control
Sensitive Files Compression,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Collection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend",Credential Access; Collection
Potential Linux Credential Dumping via Unshadow,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame",Credential Access
Linux init (PID 1) Secret Dump via GDB,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame",Credential Access
Linux Process Hooking via GDB,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Credential Access
Potential Linux Local Account Brute Force Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Potential External Linux SSH Brute Force Detected,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Potential Internal Linux SSH Brute Force Detected,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Potential Successful Linux FTP Brute Force Attack Detected,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Potential Successful Linux RDP Brute Force Attack Detected,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Potential Successful SSH Brute Force Attack,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Potential Linux Credential Dumping via Proc Filesystem,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Use Case: Vulnerability,Data Source: Elastic Defend",Credential Access
Potential OpenSSH Backdoor Logging Activity,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Credential Access; Persistence
Unusual Instance Metadata Service (IMDS) API Request,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Discovery,Data Source: Elastic Defend",Credential Access; Discovery
Access Control List Modification via setfacl,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Defense Evasion
Attempt to Disable Auditd Service,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Attempt to Disable IPTables or Firewall,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Attempt to Disable Syslog Service,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend",Defense Evasion
Base16 or Base32 Encoding/Decoding Activity,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Defense Evasion
System Binary Moved or Copied,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
File made Immutable by Chattr,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Defense Evasion
Attempt to Clear Kernel Ring Buffer,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Defense Evasion
Hidden Files and Directories via Hidden Flag,eql,"endpoint,auditd_manager,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager,Data Source: SentinelOne",Defense Evasion
Directory Creation in /bin directory,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Data Source: Elastic Defend",Defense Evasion; Persistence
Potential Disabling of AppArmor,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Defense Evasion
Potential Disabling of SELinux,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Defense Evasion
Potential Defense Evasion via Doas,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: SentinelOne",Defense Evasion
Dynamic Linker Creation or Modification,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Data Source: Elastic Defend",Defense Evasion; Persistence
ESXI Timestomping using Touch Command,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Defense Evasion
File Deletion via Shred,eql,"endpoint,crowdstrike,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Crowdstrike,Data Source: SentinelOne",Defense Evasion
File Permission Modification in Writable Directory,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Potential Hex Payload Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend",Defense Evasion; Execution
Hidden Directory Creation via Unusual Parent,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Tactic: Persistence",Defense Evasion; Persistence
Creation of Hidden Files and Directories via CommandLine,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion; Persistence
Creation of Hidden Shared Object File,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Defense Evasion
Unusual Interactive Shell Launched from System User,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Kernel Module Removal,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend",Defense Evasion; Persistence
Executable Masquerading as Kernel Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Dynamic Linker (ld.so) Creation,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Tactic: Persistence,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion; Execution; Persistence
System Log File Deletion,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Defense Evasion
Potential Hidden Process via Mount Hidepid,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Defense Evasion
Potential Defense Evasion via PRoot,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Suspicious Renaming of ESXI Files,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Suspicious Renaming of ESXI index.html File,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Root Certificate Installation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
SELinux Configuration Creation or Renaming,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Defense Evasion
SSL Certificate Deletion,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Impact,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion; Impact
Potentially Suspicious Process Started via tmux or screen,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Unusual Preload Environment Variable Process Execution,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Data Source: Elastic Defend",Defense Evasion; Persistence
Suspicious Dynamic Linker Discovery via od,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
ESXI Discovery via Find,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
ESXI Discovery via Grep,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
Enumeration of Kernel Modules,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Hping Process Activity,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Discovery
Nping Process Activity,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Discovery
Pluggable Authentication Module (PAM) Version Discovery,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Tactic: Persistence,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery; Persistence; Credential Access
Potential Network Scan Executed From Host,kuery,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
Private Key Searching Activity,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
Process Capability Enumeration,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Suspicious /proc/maps Discovery,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
Potential Pspy Process Monitoring Detected,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery",Discovery
Security File Access via Common Utilities,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
Sudo Command Enumeration Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
SUID/SGUID Enumeration Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Tactic: Privilege Escalation,Data Source: Elastic Defend",Discovery; Privilege Escalation; Persistence
Suspicious Memory grep Activity,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Suspicious which Enumeration,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Unusual User Privilege Enumeration via id,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
Virtual Machine Fingerprinting,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Data Source: Elastic Defend",Discovery
Yum/DNF Plugin Status Discovery,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Abnormal Process ID or Lock File Created,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Threat: BPFDoor,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Elastic Endgame",Execution
File Creation by Cups or Foomatic-rip Child,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Execution,Data Source: Elastic Defend",Execution
Printer User (lp) Shell Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Execution,Data Source: Elastic Defend",Execution
Cupsd or Foomatic-rip Shell Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Execution,Data Source: Elastic Defend",Execution
Suspicious Execution from Foomatic-rip or Cupsd Parent,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Execution,Data Source: Elastic Defend",Execution
Potential curl CVE-2023-38545 Exploitation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Use Case: Vulnerability,Tactic: Execution,Data Source: Elastic Defend",Execution
Egress Connection from Entrypoint in Container,eql,endpoint,rules/linux,"Domain: Endpoint,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Privilege Escalation
"File Creation, Execution and Self-Deletion in Suspicious Directory",eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution
File Transfer or Listener Established via Netcat,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: SentinelOne",Execution
Potential Upgrade of Non-interactive Shell,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Netcat Listener Established via rlwrap,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Elastic Endgame",Execution
Network Connection from Binary with RWX Memory Region,eql,"auditd_manager,endpoint",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Auditd Manager",Execution; Command and Control
Network Connection via Recently Compiled Executable,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Interactive Terminal Spawned via Perl,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Privileged Docker Container Creation,kuery,endpoint,rules/linux,"Domain: Endpoint,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Privilege Escalation
Potential Linux Hack Tool Launched,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Execution
Process Started from Process ID (PID) File,eql,"endpoint,auditd_manager,crowdstrike",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Threat: BPFDoor,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager,Data Source: Crowdstrike",Execution
Binary Executed from Shared Memory Directory,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Threat: BPFDoor,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Interactive Terminal Spawned via Python,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Web Server Spawned via Python,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Lateral Movement
Potential Code Execution via Postgresql,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Linux Restricted Shell Breakout via Linux Binary(s),eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Openssl Client or Server Activity,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Elastic Endgame",Execution; Command and Control
Potential Reverse Shell via Background Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Elastic Endgame",Execution; Command and Control
Potential Reverse Shell via Child,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Potential Reverse Shell via Java,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Potential Reverse Shell via Suspicious Child Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Potential Meterpreter Reverse Shell,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution; Command and Control
Potential Reverse Shell via Suspicious Binary,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Potential Reverse Shell,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Potential Reverse Shell via UDP,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution",Execution; Command and Control
Suspicious System Commands Executed by Previously Unknown Executable,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Suspicious Mining Process Creation Event,eql,"endpoint,crowdstrike,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Crowdstrike,Data Source: SentinelOne",Execution
Suspicious Content Extracted or Decompressed via Funzip,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution; Defense Evasion
BPF filter applied using TC,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Threat: TripleCross,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution
Unix Socket Connection,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Execution
Unknown Execution of Binary with RWX Memory Region,kuery,auditd_manager,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Auditd Manager",Execution
Potential Data Splitting Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Exfiltration,Data Source: Elastic Defend",Exfiltration
Suspicious Data Encryption via OpenSSL Utility,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Data Source: Elastic Defend",Impact
Suspicious Termination of ESXI Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Data Source: Elastic Defend,Data Source: Elastic Endgame",Impact
Memory Swap Modification,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Tactic: Execution,Data Source: Elastic Defend",Impact; Execution
Potential Linux Ransomware Note Creation Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Data Source: Elastic Defend",Impact
High Number of Process Terminations,kuery,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Impact
Potential SSH-IT SSH Worm Downloaded,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Lateral Movement
Suspicious APT Package Manager Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Execution; Defense Evasion
APT Package Manager Configuration File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Suspicious APT Package Manager Network Connection,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Command and Control,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Command and Control; Defense Evasion
At Job Created or Modified,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Execution,Data Source: Elastic Defend",Persistence; Privilege Escalation; Execution
Chkconfig Service Add,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Threat: Lightning Framework,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence
Modification of OpenSSH Binaries,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Credential Access; Lateral Movement
Cron Job Created or Modified,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Execution,Data Source: Elastic Defend",Persistence; Privilege Escalation; Execution
DNF Package Manager Plugin File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
DPKG Package Installed by Unusual Parent Process,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Initial Access
Unusual DPKG Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Initial Access
Dynamic Linker Copy,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Threat: Orbit,Data Source: Elastic Defend,Data Source: SentinelOne",Persistence
Suspicious File Creation in /etc for Persistence,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Threat: Orbit,Threat: Lightning Framework,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Execution; Privilege Escalation
Git Hook Command Execution,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Execution; Defense Evasion
Git Hook Created or Modified,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Elastic Endgame",Persistence; Execution; Defense Evasion
Git Hook Egress Network Connection,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Execution; Defense Evasion
Git Hook Child Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Execution; Defense Evasion
System V Init Script Created,eql,"endpoint,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: SentinelOne",Persistence
Kernel Module Load via insmod,eql,"endpoint,auditd_manager,sentinel_one_cloud_funnel",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Threat: Rootkit,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager,Data Source: SentinelOne",Persistence
Persistence via KDE AutoStart Script or Desktop File Modification,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence
Kernel Driver Load,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion",Persistence; Defense Evasion
Kernel Driver Load by non-root User,eql,auditd_manager,rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion",Persistence; Defense Evasion
Kernel Object File Creation,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Suspicious File Creation via Kworker,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Potential Linux Backdoor User Account Creation,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Auditd Manager",Persistence
Linux Group Creation,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide",Persistence
Potential Remote Code Execution via Web Server,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Initial Access,Data Source: Elastic Endgame,Use Case: Vulnerability,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence; Initial Access
Linux User Account Creation,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide",Persistence
Linux User Added to Privileged Group,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Auditd Manager",Persistence
Loadable Kernel Module Configuration File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Message-of-the-Day (MOTD) File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence
Process Spawned from Message-of-the-Day (MOTD),eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence
Creation or Modification of Pluggable Authentication Module or Configuration,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Credential Access
Pluggable Authentication Module (PAM) Creation in Unusual Directory,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Credential Access
Pluggable Authentication Module (PAM) Source Download,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Elastic Endgame",Persistence; Credential Access
Executable Bit Set for Potential Persistence Script,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence
Process Capability Set via setcap Utility,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Privilege Escalation
Suspicious rc.local Error Message,kuery,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence",Persistence
Potential Execution of rc.local Script,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
rc.local/rc.common File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence
RPM Package Installed by Unusual Parent Process,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Initial Access
Setcap setuid/setgid Capability Set,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Elastic Endgame",Persistence; Privilege Escalation
Shadow File Modification,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Defend",Persistence; Privilege Escalation
Shared Object Created or Changed by Previously Unknown Process,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence
Shell Configuration Creation or Modification,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Simple HTTP Web Server Connection,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Command and Control,Data Source: Elastic Defend",Persistence; Execution; Command and Control
Simple HTTP Web Server Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Tactic: Command and Control,Data Source: Elastic Defend",Persistence; Execution; Command and Control
SSH Key Generated via ssh-keygen,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Lateral Movement
Network Connection Initiated by SSHD Child Process,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Lateral Movement; Command and Control
Login via Unusual System User,eql,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: System",Persistence; Defense Evasion
Potential Suspicious File Edit,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Privilege Escalation
Potential Execution via XZBackdoor,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Tactic: Lateral Movement,Data Source: Elastic Defend",Persistence; Credential Access; Lateral Movement
Systemd Generator Created,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Defend",Persistence; Privilege Escalation
Suspicious Network Connection via systemd,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Command and Control,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Command and Control; Defense Evasion
Systemd Timer Created,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence
Systemd Service Created,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Defend",Persistence; Privilege Escalation
Systemd Service Started by Unusual Parent Process,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Defend",Persistence; Privilege Escalation
Tainted Kernel Module Load,kuery,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion",Persistence; Defense Evasion
Tainted Out-Of-Tree Kernel Module Load,kuery,system,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion",Persistence; Defense Evasion
Systemd-udevd Rule File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Authentication via Unusual PAM Grantor,kuery,auditd_manager,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Auditd Manager",Persistence; Credential Access
Unusual SSHD Child Process,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Lateral Movement; Command and Control
User or Group Creation/Modification,eql,auditd_manager,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Auditd Manager",Persistence
Network Connections Initiated Through XDG Autostart Entry,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Yum Package Manager Plugin File Creation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Potential Unauthorized Access via Wildcard Injection Detected,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Auditd Manager",Privilege Escalation; Credential Access
Potential Privilege Escalation via Container Misconfiguration,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Domain: Container,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation via Linux DAC permissions,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Docker Escape via Nsenter,eql,endpoint,rules/linux,"Domain: Endpoint,Domain: Container,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Potential Chroot Container Escape via Mount,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Domain: Container,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation via Enlightenment,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
Privilege Escalation via GDB CAP_SYS_PTRACE,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Root Network Connection via GDB CAP_SYS_PTRACE,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Execution,Tactic: Command and Control,Data Source: Elastic Defend",Privilege Escalation; Execution; Command and Control
Suspicious Kworker UID Elevation,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame",Privilege Escalation; Defense Evasion
Modification of Dynamic Linker Preload Shared Object,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend",Privilege Escalation
Suspicious Symbolic Link Created,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Credential Access,Data Source: Elastic Defend",Privilege Escalation; Credential Access
Potential Privilege Escalation via UID INT_MAX Bug Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend,Data Source: Elastic Endgame",Privilege Escalation
Kernel Load or Unload via Kexec Detected,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Privilege Escalation; Persistence; Defense Evasion
Potential Privilege Escalation via CVE-2023-4911,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
Network Connection via Sudo Binary,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend,Data Source: Elastic Endgame",Privilege Escalation
Potential Privilege Escalation via OverlayFS,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation via PKEXEC,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation; Defense Evasion
Potential Buffer Overflow Attack Detected,kuery,N/A,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Initial Access,Use Case: Vulnerability,Rule Type: Higher-Order Rule",Privilege Escalation; Initial Access
Privilege Escalation via SUID/SGID,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Persistence,Data Source: Elastic Defend",Privilege Escalation; Persistence
Potential Shell via Wildcard Injection Detected,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Execution,Data Source: Elastic Defend",Privilege Escalation; Execution
Potential Suspicious DebugFS Root Device Access,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Potential Shadow File Read via Command Line Utilities,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend",Privilege Escalation; Credential Access
Potential Sudo Privilege Escalation via CVE-2019-14287,eql,"endpoint,auditd_manager",rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend,Use Case: Vulnerability,Data Source: Elastic Endgame,Data Source: Auditd Manager",Privilege Escalation
Potential Sudo Hijacking,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Persistence,Data Source: Elastic Defend",Privilege Escalation; Persistence
Potential Sudo Token Manipulation via Process Injection,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation via Python cap_setuid,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Privilege Escalation via CAP_CHOWN/CAP_FOWNER Capabilities,eql,"endpoint,auditd_manager",rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Suspicious Passwd File Event Action,eql,"endpoint,auditd_manager",rules/linux,"Data Source: Auditd Manager,Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Privilege Escalation via CAP_SETUID/SETGID Capabilities,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation via Recently Compiled Executable,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
UID Elevation from Previously Unknown Executable,kuery,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Defend",Privilege Escalation; Defense Evasion
Namespace Manipulation Using Unshare,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend",Privilege Escalation
Potential Privilege Escalation through Writable Docker Socket,eql,endpoint,rules/linux,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Privilege Escalation,Domain: Container,Data Source: Elastic Defend",Privilege Escalation
Access to Keychain Credentials Directories,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Dumping Account Hashes via Built-In Commands,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Dumping of Keychain Content via Security Command,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Suspicious pbpaste High Volume Activity,eql,"endpoint,jamf_protect",rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Jamf Protect,Data Source: Elastic Defend",Credential Access
Kerberos Cached Credentials Dumping,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Keychain Password Retrieval via Command Line,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
WebProxy Settings Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Potential macOS SSH Brute Force Detected,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Prompt for Credentials with OSASCRIPT,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
Suspicious Web Browser Sensitive File Access,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
SystemKey Access via Command Line,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access
SoftwareUpdate Preferences Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Quarantine Attrib Removed by Unsigned or Untrusted Process,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Attempt to Disable Gatekeeper,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Attempt to Install Root Certificate,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Modification of Environment Variable via Unsigned or Untrusted Parent,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Potential Privacy Control Bypass via TCCDB Modification,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Potential Privacy Control Bypass via Localhost Secure Copy,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion; Privilege Escalation
Modification of Safari Settings via Defaults Command,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Potential Microsoft Office Sandbox Evasion,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
TCC Bypass via Mounted APFS Snapshot Access,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Use Case: Vulnerability,Data Source: Elastic Defend",Defense Evasion
Attempt to Unload Elastic Endpoint Security Kernel Extension,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion; Persistence
Enumeration of Users or Groups via Built-in Commands,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
Execution via Electron Child Process Node.js Module,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend",Execution; Defense Evasion
Suspicious Browser Child Process,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Defend",Execution; Initial Access
MacOS Installer Package Spawns Network Event,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Tactic: Command and Control,Data Source: Elastic Defend",Execution; Command and Control
Apple Script Execution followed by Network Connection,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Suspicious Automator Workflows Execution,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution
Shell Execution via Apple Scripting,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution
Suspicious macOS MS Office Child Process,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Initial Access,Data Source: Elastic Defend",Initial Access
Potential Kerberos Attack via Bifrost,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement; Credential Access
Attempt to Mount SMB Share via Command Line,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Remote SSH Login Enabled via systemsetup Command,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Virtual Private Network Connection Attempt,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Potential Hidden Local User Account Creation,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Launch Agent Creation or Modification and Immediate Loading,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Creation of Hidden Login Item via Apple Script,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Defend",Persistence; Execution; Defense Evasion
LaunchDaemon Creation or Modification and Immediate Loading,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Authorization Plugin Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Suspicious CronTab Creation or Modification,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Suspicious Hidden Child Process of Launchd,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Persistence via DirectoryService Plugin Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Persistence via Docker Shortcut Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Emond Rules Creation or Modification,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Suspicious Emond Child Process,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Attempt to Enable the Root Account,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Creation of Hidden Launch Agent or Daemon,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Finder Sync Plugin Registered and Enabled,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Persistence via Folder Action Script,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Execution
Potential Persistence via Login Hook,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence; Defense Evasion
Persistence via Login or Logout Hook,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Sublime Plugin or Application Script Modification,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Potential Persistence via Periodic Tasks,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Unexpected Child Process of macOS Screensaver Engine,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Screensaver Plist File Modified by Unexpected Process,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Suspicious Calendar File Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Potential Persistence via Atom Init Script Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend",Persistence
Apple Scripting Execution with Administrator Privileges,eql,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation; Execution
Execution with Explicit Credentials via Scripting,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Execution,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation; Execution
Suspicious Child Process of Adobe Acrobat Reader Update Service,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
Potential Admin Group Account Addition,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Privilege Escalation via Root Crontab File Modification,kuery,endpoint,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
User Added to the Admin Group,eql,jamf_protect,rules/macos,"Domain: Endpoint,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Jamf Protect",Privilege Escalation
DNS Tunneling,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Unusual DNS Activity,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Unusual Web Request,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Unusual Web User Agent,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Command and Control",Command and Control
Spike in Failed Logon Events,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access,Resources: Investigation Guide",Credential Access
Spike in Logon Events,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Spike in Successful Logon Events from a Source IP,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access,Tactic: Defense Evasion,Resources: Investigation Guide",Credential Access; Defense Evasion
Unusual Linux Process Calling the Metadata Service,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Unusual Linux User Calling the Metadata Service,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Unusual Login Activity,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Unusual Windows Process Calling the Metadata Service,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Unusual Windows User Calling the Metadata Service,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Credential Access",Credential Access
Unusual Linux System Information Discovery Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Discovery",Discovery
Unusual Linux Network Configuration Discovery,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Discovery",Discovery
Unusual Linux Network Connection Discovery,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Discovery",Discovery
Unusual Linux Process Discovery Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Discovery",Discovery
Unusual Linux User Discovery Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Discovery",Discovery
Suspicious Powershell Script,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Execution",Execution
Unusual Hour for a User to Logon,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access,Resources: Investigation Guide",Initial Access
Unusual Source IP for a User to Logon from,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access",Initial Access
Rare User Logon,N/A,"auditd_manager,endpoint,system",rules/ml,"Use Case: Identity and Access Audit,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access,Resources: Investigation Guide",Initial Access
Unusual Linux Username,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access",Initial Access
Unusual Windows Username,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access",Initial Access
Unusual Windows Remote User,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Initial Access",Initial Access
Spike in Firewall Denies,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Spike in Network Traffic,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Unusual Linux Network Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Unusual Linux Network Port Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Unusual Network Destination Domain Name,N/A,"auditd_manager,endpoint",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Network Traffic to Rare Destination Country,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Spike in Network Traffic To a Country,N/A,"endpoint,network_traffic",rules/ml,"Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Unusual Windows Network Activity,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning",N/A
Anomalous Process For a Linux Population,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence,Resources: Investigation Guide",Persistence
Unusual Process For a Linux Host,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence",Persistence
Unusual Process For a Windows Host,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence,Resources: Investigation Guide",Persistence
Unusual Windows Path Activity,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence,Tactic: Execution",Persistence; Execution
Anomalous Process For a Windows Population,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence,Tactic: Execution",Persistence; Execution
Anomalous Windows Process Creation,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence,Resources: Investigation Guide",Persistence
Unusual Windows Service,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Persistence",Persistence
Unusual Sudo Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Privilege Escalation",Defense Evasion; Privilege Escalation
Unusual Windows User Privilege Elevation Activity,N/A,"endpoint,windows",rules/ml,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Privilege Escalation",Privilege Escalation
Anomalous Linux Compiler Activity,N/A,"auditd_manager,endpoint",rules/ml,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Rule Type: ML,Rule Type: Machine Learning,Tactic: Resource Development",Resource Development
Accepted Default Telnet Port Connection,kuery,"network_traffic,panw",rules/network,"Domain: Endpoint,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Lateral Movement,Tactic: Initial Access,Data Source: PAN-OS",Command and Control; Lateral Movement; Initial Access
Cobalt Strike Command and Control Beacon,lucene,network_traffic,rules/network,"Use Case: Threat Detection,Tactic: Command and Control,Domain: Endpoint",Command and Control
Default Cobalt Strike Team Server Certificate,kuery,network_traffic,rules/network,"Tactic: Command and Control,Threat: Cobalt Strike,Use Case: Threat Detection,Domain: Endpoint",Command and Control
Roshal Archive (RAR) or PowerShell File Downloaded from the Internet,kuery,"network_traffic,panw",rules/network,"Use Case: Threat Detection,Tactic: Command and Control,Domain: Endpoint,Data Source: PAN-OS",Command and Control
Possible FIN7 DGA Command and Control Behavior,lucene,"network_traffic,panw",rules/network,"Use Case: Threat Detection,Tactic: Command and Control,Domain: Endpoint,Data Source: PAN-OS",Command and Control
Halfbaked Command and Control Beacon,lucene,network_traffic,rules/network,"Use Case: Threat Detection,Tactic: Command and Control,Domain: Endpoint",Command and Control
IPSEC NAT Traversal Port Activity,kuery,"network_traffic,panw",rules/network,"Tactic: Command and Control,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Command and Control
SMTP on Port 26/TCP,kuery,"network_traffic,panw",rules/network,"Tactic: Command and Control,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Command and Control; Exfiltration
RDP (Remote Desktop Protocol) from the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Command and Control,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Command and Control; Lateral Movement; Initial Access
VNC (Virtual Network Computing) from the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Command and Control,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Command and Control; Initial Access
VNC (Virtual Network Computing) to the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Command and Control,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Command and Control
Potential Network Sweep Detected,kuery,"endpoint,network_traffic,panw",rules/network,"Domain: Network,Tactic: Discovery,Tactic: Reconnaissance,Use Case: Network Security Monitoring,Data Source: Elastic Defend,Data Source: PAN-OS",Discovery; Reconnaissance
Potential Network Scan Detected,kuery,"endpoint,network_traffic,panw",rules/network,"Domain: Network,Tactic: Discovery,Tactic: Reconnaissance,Use Case: Network Security Monitoring,Data Source: Elastic Defend,Data Source: PAN-OS",Discovery; Reconnaissance
Potential SYN-Based Network Scan Detected,kuery,"endpoint,network_traffic,panw",rules/network,"Domain: Network,Tactic: Discovery,Tactic: Reconnaissance,Use Case: Network Security Monitoring,Data Source: Elastic Defend,Data Source: PAN-OS",Discovery; Reconnaissance
RPC (Remote Procedure Call) from the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Initial Access,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Initial Access
RPC (Remote Procedure Call) to the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Initial Access,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Initial Access
SMB (Windows File Sharing) Activity to the Internet,kuery,"network_traffic,panw",rules/network,"Tactic: Initial Access,Domain: Endpoint,Use Case: Threat Detection,Data Source: PAN-OS",Initial Access; Exfiltration
Inbound Connection to an Unsecure Elasticsearch Node,lucene,network_traffic,rules/network,"Use Case: Threat Detection,Tactic: Initial Access,Domain: Endpoint",Initial Access
Abnormally Large DNS Response,kuery,network_traffic,rules/network,"Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Use Case: Vulnerability",Lateral Movement
Credential Dumping - Detected - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Credential Dumping - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Credential Access",Credential Access
Adversary Behavior - Detected - Elastic Endgame,kuery,N/A,rules/promotions,Data Source: Elastic Endgame,N/A
Malware - Detected - Elastic Endgame,kuery,N/A,rules/promotions,Data Source: Elastic Endgame,N/A
Malware - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,Data Source: Elastic Endgame,N/A
Ransomware - Detected - Elastic Endgame,kuery,N/A,rules/promotions,Data Source: Elastic Endgame,N/A
Ransomware - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,Data Source: Elastic Endgame,N/A
Exploit - Detected - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Execution,Tactic: Privilege Escalation",Execution; Privilege Escalation
Exploit - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Execution,Tactic: Privilege Escalation",Execution; Privilege Escalation
External Alerts,kuery,N/A,rules/promotions,"OS: Windows,Data Source: APM,OS: macOS,OS: Linux",N/A
Credential Manipulation - Detected - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Credential Manipulation - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Permission Theft - Detected - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Permission Theft - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Process Injection - Detected - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Process Injection - Prevented - Elastic Endgame,kuery,N/A,rules/promotions,"Data Source: Elastic Endgame,Use Case: Threat Detection,Tactic: Privilege Escalation",Privilege Escalation
Threat Intel IP Address Indicator Match,kuery,N/A,rules/threat_intel,"OS: Windows,Data Source: Elastic Endgame,Rule Type: Threat Match",N/A
Threat Intel Hash Indicator Match,kuery,N/A,rules/threat_intel,"OS: Windows,Data Source: Elastic Endgame,Rule Type: Threat Match",N/A
Threat Intel Windows Registry Indicator Match,kuery,N/A,rules/threat_intel,"OS: Windows,Data Source: Elastic Endgame,Rule Type: Threat Match",N/A
Threat Intel URL Indicator Match,kuery,N/A,rules/threat_intel,"OS: Windows,Data Source: Elastic Endgame,Rule Type: Threat Match",N/A
Rapid7 Threat Command CVEs Correlation,kuery,ti_rapid7_threat_command,rules/threat_intel,"OS: Windows,Data Source: Elastic Endgame,Data Source: Windows,Data Source: Network,Data Source: Rapid7 Threat Command,Rule Type: Threat Match,Resources: Investigation Guide,Use Case: Vulnerability,Use Case: Asset Visibility,Use Case: Continuous Monitoring",N/A
Suspicious Inter-Process Communication via Outlook,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: Elastic Defend",Collection; Execution
Exporting Exchange Mailbox via PowerShell,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Collection; Execution
Exchange Mailbox Export via PowerShell,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Resources: Investigation Guide,Data Source: PowerShell Logs",Collection
PowerShell Suspicious Script with Audio Capture Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Resources: Investigation Guide,Data Source: PowerShell Logs",Collection; Execution
PowerShell Suspicious Script with Clipboard Retrieval Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: PowerShell Logs,Resources: Investigation Guide",Collection; Execution
PowerShell Keylogging Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Resources: Investigation Guide,Data Source: PowerShell Logs",Collection; Execution
PowerShell Mailbox Collection Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: PowerShell Logs,Resources: Investigation Guide",Collection; Execution
PowerShell Suspicious Script with Screenshot Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Resources: Investigation Guide,Data Source: PowerShell Logs",Collection; Execution
PowerShell Script with Webcam Video Capture Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: PowerShell Logs",Collection; Execution
Encrypting Files with WinRar or 7z,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Collection
Potential File Transfer via Certreq,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Command and Control,Tactic: Exfiltration,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Command and Control; Defense Evasion; Exfiltration
Connection to Commonly Abused Web Services,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend",Command and Control; Exfiltration
Potential DNS Tunneling via NsLookup,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon",Command and Control
Connection to Commonly Abused Free SSL Certificate Providers,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Data Source: Sysmon",Command and Control
Potential File Download via a Headless Browser,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Windows,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon,Data Source: Crowdstrike",Command and Control
Potential Command and Control via Internet Explorer,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control; Execution
Ingress Transfer via Windows BITS,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Command and Control,Data Source: Elastic Defend",Command and Control; Defense Evasion
First Time Seen Commonly Abused Remote Access Tool Execution,kuery,"endpoint,windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: System",Command and Control
Outlook Home Page Registry Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Command and Control; Persistence
Port Forwarding Rule Addition,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Command and Control; Defense Evasion
Potential Remote Desktop Tunneling Detected,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Command and Control; Lateral Movement
Remote File Download via Desktopimgdownldr Utility,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon,Data Source: Crowdstrike",Command and Control
Remote File Download via MpCmdRun,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Command and Control
Remote File Download via PowerShell,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend",Command and Control; Execution
Remote File Download via Script Interpreter,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Command and Control; Execution
Suspicious ScreenConnect Client Child Process,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Command and Control
SUNBURST Command and Control Activity,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend",Command and Control; Initial Access
Remote File Copy via TeamViewer,eql,"endpoint,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: SentinelOne",Command and Control
Attempt to Establish VScode Remote Tunnel,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Command and Control
Potential ADIDNS Poisoning via Wildcard Record Creation,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Potential WPAD Spoofing via DNS Record Creation,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Privileged Account Brute Force,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: System",Credential Access
Multiple Logon Failure Followed by Logon Success,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: System",Credential Access
Multiple Logon Failure from the same Source Address,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: System",Credential Access
Potential Credential Access via Windows Utilities,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon",Credential Access; Defense Evasion
NTDS or SAM Database File Copied,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon,Data Source: Crowdstrike",Credential Access
Potential Credential Access via Trusted Developer Utility,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Credential Access; Defense Evasion
FirstTime Seen Account Performing DCSync,kuery,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Privilege Escalation,Use Case: Active Directory Monitoring,Data Source: Active Directory,Resources: Investigation Guide,Data Source: System",Credential Access; Privilege Escalation
Potential Credential Access via DCSync,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Privilege Escalation,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Credential Access; Privilege Escalation
Potential Active Directory Replication Account Backdoor,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Creation of a DNS-Named Record,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Potential Relay Attack against a Domain Controller,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Active Directory,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Creation or Modification of Domain Backup DPAPI private key,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Credential Access
Credential Acquisition via Registry Hive Dumping,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon,Data Source: Crowdstrike",Credential Access
Full User-Mode Dumps Enabled System-Wide,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Credential Access; Defense Evasion
Microsoft IIS Connection Strings Decryption,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access
Untrusted DLL Loaded by Azure AD Sync Service,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Sysmon",Credential Access
Kerberos Traffic from Unusual Process,eql,"endpoint,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: SentinelOne",Credential Access
Kirbi File Creation,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: Elastic Endgame,Data Source: Crowdstrike",Credential Access
Access to a Sensitive LDAP Attribute,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Privilege Escalation,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Credential Access; Privilege Escalation
Suspicious LSASS Access via MalSecLogon,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Sysmon",Credential Access
Suspicious Module Loaded by LSASS,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Data Source: Elastic Endgame",Credential Access
LSASS Memory Dump Creation,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Credential Access
LSASS Memory Dump Handle Access,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: System",Credential Access
LSASS Process Access via Windows API,eql,"endpoint,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Execution,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint",Credential Access; Execution
Mimikatz Memssp Log File Detected,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Credential Access
Potential Invoke-Mimikatz PowerShell Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: PowerShell Logs",Credential Access
Modification of WDigest Security Provider,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Credential Access
Windows Registry File Creation in SMB Share,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Defend",Credential Access; Lateral Movement
Network Logon Provider Registry Modification,eql,"endpoint,m365_defender,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Credential Access; Persistence
PowerShell Invoke-NinjaCopy script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: PowerShell Logs,Resources: Investigation Guide",Credential Access; Execution; Defense Evasion
PowerShell Kerberos Ticket Dump,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: PowerShell Logs",Credential Access; Execution
PowerShell MiniDump Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: PowerShell Logs",Credential Access; Execution
Potential PowerShell Pass-the-Hash/Relay Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: PowerShell Logs",Credential Access; Execution; Lateral Movement
PowerShell Kerberos Ticket Request,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: PowerShell Logs",Credential Access; Execution
PowerShell Script with Veeam Credential Access Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: PowerShell Logs",Credential Access; Execution
Potential Credential Access via DuplicateHandle in LSASS,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Sysmon",Credential Access
Sensitive Registry Hive Access via RegBack,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Defend",Credential Access
Potential Local NTLM Relay via HTTP,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access; Defense Evasion
Potential Remote Credential Access via Registry,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Defend",Credential Access; Lateral Movement
Searching for Saved Credentials via VaultCmd,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access
Multiple Vault Web Credentials Read,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: System",Credential Access
Sensitive Privilege SeEnableDelegationPrivilege assigned to a User,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Persistence,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Credential Access; Persistence
Potential Shadow Credentials added to AD Object,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
User account exposed to Kerberoasting,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Credential Access
Potential Credential Access via Renamed COM+ Services DLL,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Defense Evasion,Data Source: Sysmon",Credential Access; Defense Evasion
Suspicious Lsass Process Access,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Sysmon",Credential Access
Potential Credential Access via LSASS Memory Dump,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic:Execution,Data Source: Sysmon",Credential Access; Execution
Potential LSASS Memory Dump via PssCaptureSnapShot,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Sysmon",Credential Access
Suspicious Remote Registry Access via SeBackupPrivilege,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Credential Access,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Credential Access; Lateral Movement
Symbolic Link to Shadow Copy Created,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access
Veeam Backup Library Loaded by Unusual Process,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend",Credential Access; Execution
Potential Veeam Credential Access Command,eql,"windows,endpoint,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access; Execution
Potential LSASS Clone Creation via PssCaptureSnapShot,eql,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Sysmon,Data Source: System",Credential Access
NTDS Dump via Wbadmin,eql,"windows,endpoint,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access; Defense Evasion
Wireless Credential Dumping using Netsh Command,eql,"endpoint,system,windows,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Discovery,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Credential Access; Discovery
Adding Hidden File Attribute via Attrib,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Persistence
Modification of AmsiEnable Registry Key,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Suspicious Antimalware Scan Interface DLL,eql,"windows,endpoint,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Clearing Windows Console History,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Clearing Windows Event Logs,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Windows Event Logs Cleared,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: System",Defense Evasion
Code Signing Policy Modification Through Built-in tools,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Code Signing Policy Modification Through Registry,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Creation or Modification of Root Certificate,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Windows CryptoAPI Spoofing Vulnerability (CVE-2020-0601 - CurveBall),kuery,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Use Case: Vulnerability,Data Source: System",Defense Evasion
Windows Defender Disabled via Registry Modification,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Windows Defender Exclusions Added via PowerShell,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Delete Volume USN Journal with Fsutil,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Network-Level Authentication (NLA) Disabled,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon",Defense Evasion
PowerShell Script Block Logging Disabled,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Disable Windows Firewall Rules via Netsh,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Disabling Windows Defender Security Settings via PowerShell,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Disable Windows Event and Security Logs Using Built-in Tools,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
DNS-over-HTTPS Enabled via Registry,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Suspicious .NET Code Compilation,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Remote Desktop Enabled in Windows Firewall by Netsh,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Enable Host Network Discovery via Netsh,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Control Panel Process with Unusual Arguments,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
ImageLoad via Windows Update Auto Update Client,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Microsoft Build Engine Started by an Office Application,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Microsoft Build Engine Started by a Script Process,kuery,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend",Defense Evasion; Execution
Microsoft Build Engine Started by a System Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Microsoft Build Engine Using an Alternate Name,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Microsoft Build Engine Started an Unusual Process,kuery,"endpoint,windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend,Data Source: System",Defense Evasion
Potential DLL Side-Loading via Trusted Microsoft Programs,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Potential DLL Side-Loading via Microsoft Antimalware Service Executable,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Executable File Creation with Multiple Extensions,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Execution
Process Execution from an Unusual Directory,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion
Encoded Executable Stored in the Registry,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Defense Evasion
IIS HTTP Logging Disabled,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Process Injection by the Microsoft Build Engine,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Privilege Escalation,Data Source: Sysmon",Defense Evasion; Privilege Escalation
InstallUtil Process Making Network Connections,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Execution via Windows Command Debugging Utility,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Defense Evasion
Suspicious Endpoint Security Parent Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion
Potential Masquerading as Business App Installer,eql,endpoint,rules/windows,"Domain: Endpoint,Data Source: Elastic Defend,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Initial Access,Tactic: Execution",Defense Evasion; Initial Access; Execution
Potential Masquerading as Communication Apps,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion; Persistence
Renamed AutoIt Scripts Interpreter,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Suspicious WerFault Child Process,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion; Persistence; Privilege Escalation
Program Files Directory Masquerading,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Potential Windows Error Manager Masquerading,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Microsoft Windows Defender Tampering,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion
Network Connection via Signed Binary,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
MsBuild Making Network Connections,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Mshta Making Network Connections,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
MsiExec Service Child Process With Network Connection,eql,"endpoint,windows,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion
Network Connection via MsXsl,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
MS Office Macro Security Registry Modifications,eql,"windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Execution
Unusual Network Activity from a Windows System Binary,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Parent Process PID Spoofing,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Privilege Escalation,Data Source: Elastic Defend",N/A
Local Account TokenFilter Policy Disabled,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Defense Evasion; Lateral Movement
Suspicious .NET Reflection via PowerShell,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: PowerShell Logs",Defense Evasion; Execution
PowerShell Suspicious Payload Encoded and Compressed,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: PowerShell Logs",Defense Evasion; Execution
PowerShell Script with Encryption/Decryption Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: PowerShell Logs,Resources: Investigation Guide",Defense Evasion
Potential PowerShell Obfuscated Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: PowerShell Logs",Defense Evasion; Execution
Potential Process Injection via PowerShell,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: PowerShell Logs",Defense Evasion; Execution
Windows Firewall Disabled via PowerShell,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion; Execution
Process Termination followed by Deletion,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend",Defense Evasion
Suspicious Microsoft Diagnostics Wizard Execution,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon",Defense Evasion
DNS Global Query Block List Modified or Disabled,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion; Credential Access
Alternate Data Stream Creation/Execution at Volume Root Directory,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion
Unusual Child Processes of RunDLL32,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Potential Windows Session Hijacking via CcmExec,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Scheduled Tasks AT Command Enabled,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Execution
Script Execution via Microsoft HTML Application,eql,"windows,system,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: System,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Service DACL Modification via sc.exe,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Defense Evasion; Persistence
Potential Secure File Deletion via SDelete Utility,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Impact,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Impact
SIP Provider Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
SolarWinds Process Disabling Services via Registry,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Initial Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Initial Access
Suspicious CertUtil Commands,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Suspicious Execution from a Mounted Device,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion; Execution
Suspicious Managed Code Hosting Process,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame,Data Source: Crowdstrike",Defense Evasion
Suspicious Process Access via Direct System Call,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Sysmon",Defense Evasion; Execution
Suspicious Process Creation CallTrace,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Sysmon",Defense Evasion
Suspicious Script Object Execution,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Sysmon",Defense Evasion
Renamed Utility Executed with Short Program Name,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Defense Evasion
Suspicious WMIC XSL Script Execution,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion; Execution
Suspicious Zoom Child Process,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Defense Evasion; Execution
Unusual Executable File Creation by a System Critical Process,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion; Execution
File Creation Time Changed,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Sysmon",Defense Evasion
Unsigned DLL Side-Loading from a Suspicious Folder,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Untrusted Driver Loaded,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend",Defense Evasion
Unusual File Creation - Alternate Data Stream,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame",Defense Evasion
Unusual Process Execution Path - Alternate Data Stream,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Unusual Network Connection via DllHost,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Unusual Network Connection via RunDLL32,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion; Command and Control
Unusual Process Network Connection,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Unusual Child Process from a System Virtual Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion
Potential Evasion via Filter Manager,eql,"endpoint,windows,m365_defender,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: System",Defense Evasion
Potential Evasion via Windows Filtering Platform,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: System",Defense Evasion
Signed Proxy Execution via MS Work Folders,eql,"windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Suspicious Execution via Windows Subsystem for Linux,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Defense Evasion; Execution
Execution via Windows Subsystem for Linux,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Windows Subsystem for Linux Enabled via Dism Utility,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Host Files System Changes via Windows Subsystem for Linux,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Defense Evasion
Attempt to Install Kali Linux via WSL,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Defense Evasion
Windows Subsystem for Linux Distribution Installed,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Defense Evasion
Potential Enumeration via Active Directory Web Service,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend",Discovery
AdFind Command Activity,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Discovery
Enumeration of Administrator Accounts,eql,"endpoint,windows,system,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Discovery
Account Discovery Command via SYSTEM Account,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Discovery; Privilege Escalation
Enumerating Domain Trusts via DSQUERY.EXE,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Discovery
Enumerating Domain Trusts via NLTEST.EXE,eql,"endpoint,windows,system,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: Crowdstrike",Discovery
Group Policy Discovery via Microsoft GPResult Utility,eql,"windows,endpoint,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Discovery
Suspicious Access to LDAP Attributes,eql,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: System,Data Source: Active Directory,Data Source: Windows",Discovery
Peripheral Device Discovery,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Discovery
PowerShell Share Enumeration Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Collection,Tactic: Execution,Resources: Investigation Guide,Data Source: PowerShell Logs",Discovery; Execution; Collection
PowerShell Suspicious Discovery Related Windows API Functions,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Collection,Tactic: Execution,Resources: Investigation Guide,Data Source: PowerShell Logs",Discovery; Execution; Collection
Enumeration of Privileged Local Groups Membership,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: System",Discovery
Unusual Discovery Signal Alert with Unusual Process Command Line,kuery,N/A,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: Higher-Order Rule",Discovery
Unusual Discovery Signal Alert with Unusual Process Executable,kuery,N/A,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: Higher-Order Rule",Discovery
Whoami Process Activity,eql,"endpoint,system,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: System",Discovery
Command Execution via SolarWinds Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Initial Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution; Initial Access
Suspicious SolarWinds Child Process,eql,"endpoint,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Execution; Initial Access
Command Prompt Network Connection,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Command and Control
Svchost spawning Cmd,kuery,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Execution
Unusual Parent Process for cmd.exe,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Execution
Command Shell Activity Started via RunDLL32,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Credential Access,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Execution; Credential Access; Defense Evasion
Execution of COM object via Xwizard,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution
Delayed Execution via Ping,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Defend",Execution; Defense Evasion
Downloaded Shortcut Files,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Initial Access
Downloaded URL Files,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Initial Access
Enumeration Command Spawned via WMIPrvSE,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution; Discovery
Execution from Unusual Directory - Command Line,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Execution; Defense Evasion
Network Connection via Compiled HTML File,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Defense Evasion
Potential Foxmail Exploitation,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: System,Data Source: Elastic Endgame,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Execution; Initial Access
Unusual Execution via Microsoft Common Console File,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Initial Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Execution; Initial Access
WPS Office Exploitation via DLL Hijack,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Initial Access
Mofcomp Activity,eql,"endpoint,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Elastic Endgame,Data Source: System,Data Source: Crowdstrike",Execution; Persistence
Execution of File Written or Modified by Microsoft Office,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend",Execution; Initial Access
Execution of File Written or Modified by PDF Reader,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Initial Access
Potential PowerShell HackTool Script by Author,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: PowerShell Logs",Execution
Potential PowerShell HackTool Script by Function Names,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: PowerShell Logs",Execution
Suspicious Portable Executable Encoded in Powershell Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: PowerShell Logs",Execution; Defense Evasion
PowerShell PSReflect Script,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: PowerShell Logs",Execution
Suspicious PowerShell Execution via Windows Scripts,eql,"windows,system,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: System,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Execution
PsExec Network Connection,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Lateral Movement
Network Connection via Registration Utility,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Execution; Defense Evasion
Outbound Scheduled Task Activity via PowerShell,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon",Execution
Execution via local SxS Shared Module,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Execution
Suspicious Cmd Execution via WMI,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution
Suspicious WMI Image Load from MS Office,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Execution
Suspicious PDF Reader Child Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Initial Access,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution; Initial Access
Suspicious PowerShell Engine ImageLoad,kuery,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend",Execution
Suspicious Process Execution via Renamed PsExec Executable,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Execution; Defense Evasion
Process Activity via Compiled HTML File,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Execution; Defense Evasion
Conhost Spawned By Suspicious Parent Process,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Execution; Defense Evasion; Privilege Escalation
Microsoft Management Console File from Unusual Path,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender,system,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Execution; Defense Evasion
Suspicious Windows Command Shell Arguments,eql,"windows,system,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: System,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Execution
Rare SMB Connection to the Internet,kuery,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Exfiltration,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Exfiltration
Third-party Backup Files Deleted via Unexpected Process,eql,"endpoint,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne",Impact
Deleting Backup Catalogs with Wbadmin,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Impact
Potential Ransomware Behavior - High count of Readme files by System,kuery,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Impact; Lateral Movement
Modification of Boot Configuration,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Impact
Suspicious File Renamed via SMB,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Defend",Impact; Lateral Movement
Potential Ransomware Note File Dropped via SMB,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Defend",Impact; Lateral Movement
High Number of Process and/or Service Terminations,kuery,"endpoint,windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System",Impact
Volume Shadow Copy Deleted or Resized via VssAdmin,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Impact
Volume Shadow Copy Deletion via PowerShell,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Impact; Execution
Volume Shadow Copy Deletion via WMIC,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Impact,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Impact; Execution
Suspicious HTML File Creation,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Data Source: Elastic Defend",Initial Access; Defense Evasion
Suspicious Execution from INET Cache,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Initial Access; Command and Control
Execution from a Removable Media with Network Connection,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Data Source: Elastic Defend",Initial Access
Potential Remote File Execution via MSIEXEC,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Defense Evasion,Data Source: Elastic Defend",Initial Access; Defense Evasion
Suspicious Execution via Microsoft Office Add-Ins,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Persistence
First Time Seen Removable Device,kuery,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Exfiltration,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Exfiltration
Suspicious JetBrains TeamCity Child Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Sysmon,Data Source: SentinelOne",Initial Access; Execution
Remote Desktop File Opened from Suspicious Path,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Initial Access
Windows Script Interpreter Executing Process via WMI,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Initial Access; Execution
Windows Script Executing PowerShell,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Execution
Microsoft Exchange Server UM Writing Suspicious Files,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Lateral Movement,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Lateral Movement
Microsoft Exchange Server UM Spawning Suspicious Processes,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Lateral Movement,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Initial Access; Lateral Movement
Microsoft Exchange Worker Spawning Suspicious Processes,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Execution
Suspicious MS Office Child Process,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Initial Access; Execution; Defense Evasion
Suspicious MS Outlook Child Process,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Defense Evasion,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Initial Access; Execution; Defense Evasion
Suspicious Explorer Child Process,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Initial Access; Execution; Defense Evasion
ScreenConnect Server Spawning Suspicious Processes,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Crowdstrike",Initial Access; Execution
Remote XSL Script Execution via COM,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Defense Evasion,Data Source: Elastic Defend",Initial Access; Defense Evasion
Potential Pass-the-Hash (PtH) Attempt,kuery,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: System",Lateral Movement
Service Command Lateral Movement,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Persistence; Execution
Incoming DCOM Lateral Movement via MSHTA,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Defense Evasion
Incoming DCOM Lateral Movement with MMC,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Defense Evasion
Incoming DCOM Lateral Movement with ShellBrowserWindow or ShellWindows,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement
NullSessionPipe Registry Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Lateral Movement; Defense Evasion
SMB Connections via LOLBin or Untrusted Process,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Defend",Lateral Movement
Potential Remote Desktop Shadowing Activity,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Lateral Movement
Potential Lateral Tool Transfer via SMB Share,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Defend",Lateral Movement
Execution via TSClient Mountpoint,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Lateral Movement
Remote Execution via File Shares,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend",Lateral Movement
Incoming Execution via WinRM Remote Shell,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement
WMI Incoming Lateral Movement,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Execution
Mounting Hidden or WebDav Remote Shares,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Initial Access,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Lateral Movement; Initial Access; Discovery
Incoming Execution via PowerShell Remoting,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Execution,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Execution
RDP Enabled via Registry,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Lateral Movement; Defense Evasion
Potential SharpRDP Behavior,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Remote File Copy to a Hidden Share,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Lateral Movement
Remotely Started Services via RPC,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement
Remote Windows Service Installed,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Persistence,Data Source: System",Lateral Movement; Persistence
Remote Scheduled Task Creation via RPC,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: System",Lateral Movement; Execution
Remote Scheduled Task Creation,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement; Execution
Suspicious RDP ActiveX Client Loaded,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement
Unusual Child Process of dns.exe,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Resources: Investigation Guide,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Lateral Movement
Unusual File Modification by dns.exe,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Sysmon",Lateral Movement
Lateral Movement via Startup Folder,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Lateral Movement; Persistence
Potential WSUS Abuse for Lateral Movement,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Lateral Movement
Adobe Hijack Persistence,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Persistence
AdminSDHolder Backdoor,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Persistence
Registry Persistence via AppCert DLL,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Persistence; Privilege Escalation
Registry Persistence via AppInit DLL,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Installation of Custom Shim Databases,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame",Persistence
Browser Extension Install,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: SentinelOne,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Persistence
Creation of a Hidden Local User Account,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence
Image File Execution Options Injection,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Suspicious Startup Shell Folder Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Active Directory Group Modification by SYSTEM,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Persistence; Privilege Escalation
Persistence via Scheduled Job Creation,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Persistence
Local Scheduled Task Creation,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Sysmon",Persistence
Scheduled Task Created by a Windows Script,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Persistence; Execution
KRBTGT Delegation Backdoor,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Persistence; Credential Access
Persistence via a Windows Installer,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend",Persistence; Defense Evasion
Office Test Registry Persistence,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Persistence via Microsoft Office AddIns,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence
Persistence via Microsoft Outlook VBA,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence
Netsh Helper DLL,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon",Persistence; Defense Evasion
New ActiveSyncAllowedDeviceID Added via PowerShell,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence; Execution
Persistence via PowerShell profile,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Privilege Escalation
Potential Modification of Accessibility Binaries,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Persistence; Privilege Escalation
Uncommon Registry Persistence Change,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Data Source: Sysmon",Persistence; Defense Evasion
Account Password Reset Remotely,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Impact,Data Source: System",Persistence; Impact
Execution of Persistent Suspicious Program,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Persistence
Startup or Run Key Registry Modification,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence
A scheduled task was created,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: System",Persistence
A scheduled task was updated,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: System",Persistence
AdminSDHolder SDProp Exclusion Added,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Persistence
Unusual Persistence via Services Registry,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Unsigned DLL Loaded by Svchost,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend",Persistence; Defense Evasion; Execution
Suspicious Service was Installed in the System,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: System",Persistence
Startup Persistence by a Suspicious Process,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence
Startup Folder Persistence via Unsigned Process,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Defend",Persistence; Defense Evasion
Persistent Scripts in the Startup Directory,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence
Component Object Model Hijacking,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Privilege Escalation; Defense Evasion
Suspicious Image Load (taskschd.dll) from MS Office,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Persistence; Execution
Suspicious Execution via Scheduled Task,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Defend",Persistence; Execution
Suspicious ImagePath Service Creation,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Suspicious WMI Event Subscription Created,eql,"windows,endpoint",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Sysmon,Data Source: Elastic Defend",Persistence
System Shells via Services,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Crowdstrike",Persistence; Execution
Temporarily Scheduled Task Creation,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: System",Persistence; Execution
Potential Persistence via Time Provider Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Privilege Escalation
User Added to Privileged Group,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Persistence
User Account Creation,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence
Windows User Account Creation,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: System",Persistence
Potential Application Shimming via Sdbinst,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence; Privilege Escalation
Persistence via BITS Job Notify Cmdline,eql,"endpoint,windows,sentinel_one_cloud_funnel,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Persistence
Persistence via Hidden Run Key Detected,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Persistence; Execution; Defense Evasion
Installation of Security Support Provider,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Persistence; Defense Evasion
Persistence via TelemetryController Scheduled Task Hijack,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence; Privilege Escalation
Persistence via Update Orchestrator Service Hijack,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Use Case: Vulnerability,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne",Persistence; Privilege Escalation
Persistence via WMI Event Subscription,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence; Execution
Persistence via WMI Standard Registry Provider,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend",Persistence; Execution
Execution via MSSQL xp_cmdshell Stored Procedure,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Persistence; Execution
Web Shell Detection: Script Process Child of Common Web Processes,eql,"endpoint,windows,system,sentinel_one_cloud_funnel,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Initial Access,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: SentinelOne,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: Crowdstrike",Persistence; Initial Access; Execution
Werfault ReflectDebugger Persistence,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Sysmon",Persistence; Defense Evasion
Process Creation via Secondary Logon,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: System",Privilege Escalation
Process Created with a Duplicated Token,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Modification of the msPKIAccountCredentials,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Data Source: Active Directory,Tactic: Privilege Escalation,Use Case: Active Directory Monitoring,Data Source: System",Privilege Escalation
Disabling User Account Control via Registry Modification,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion
Unsigned DLL loaded by DNS Service,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend,Data Source: Sysmon",Privilege Escalation
First Time Seen Driver Loaded,kuery,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Persistence,Resources: Investigation Guide,Data Source: Elastic Defend",Privilege Escalation; Persistence
Expired or Revoked Driver Loaded,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Defend",Privilege Escalation; Defense Evasion
Potential privilege escalation via CVE-2022-38028,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion
Creation or Modification of a new GPO Scheduled Task or Service,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Persistence,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Persistence
Startup/Logon Script added to Group Policy Object,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Privilege Escalation
Group Policy Abuse for Privilege Addition,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Privilege Escalation
Scheduled Task Execution at Scale via GPO,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Lateral Movement,Data Source: Active Directory,Resources: Investigation Guide,Use Case: Active Directory Monitoring,Data Source: System",Privilege Escalation; Lateral Movement
Potential Privilege Escalation via InstallerFileTakeOver,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Resources: Investigation Guide,Use Case: Vulnerability,Data Source: Elastic Defend",Privilege Escalation
Service Creation via Local Kerberos Authentication,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Credential Access,Use Case: Active Directory Monitoring,Data Source: Active Directory,Data Source: System",Privilege Escalation; Credential Access
Potential LSA Authentication Package Abuse,eql,"endpoint,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint",Privilege Escalation; Persistence
Interactive Logon by an Unusual Process,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: System",Privilege Escalation
Potential Escalation via Vulnerable MSI Repair,eql,"endpoint,sentinel_one_cloud_funnel,m365_defender,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Microsoft Defender for Endpoint",Privilege Escalation; Defense Evasion
Privilege Escalation via Named Pipe Impersonation,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Privilege Escalation
First Time Seen NewCredentials Logon Process,kuery,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: System",Privilege Escalation
Suspicious DLL Loaded for Persistence or Privilege Escalation,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon",Privilege Escalation; Persistence; Defense Evasion
Potential Port Monitor or Print Processor Registration Abuse,eql,"endpoint,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint",Privilege Escalation; Persistence
PowerShell Script with Token Impersonation Capabilities,kuery,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: PowerShell Logs",Privilege Escalation; Execution
Suspicious Print Spooler Point and Print DLL,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Sysmon",Privilege Escalation
Suspicious PrintSpooler Service Executable File Creation,kuery,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation
Suspicious Print Spooler File Deletion,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation
Suspicious Print Spooler SPL File Created,eql,"endpoint,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint",Privilege Escalation
Potential Privilege Escalation via Service ImagePath Modification,eql,"endpoint,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Privilege Escalation,Data Source: Elastic Defend,Data Source: Sysmon",Privilege Escalation; Execution
Privilege Escalation via Windir Environment Variable,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation
Potential Privileged Escalation via SamAccountName Spoofing,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Tactic: Privilege Escalation,Use Case: Active Directory Monitoring,Data Source: Active Directory,Use Case: Vulnerability,Data Source: System",Privilege Escalation; Persistence
Service Control Spawned via Script Interpreter,eql,"endpoint,system,windows,m365_defender,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Crowdstrike",Privilege Escalation; Execution; Defense Evasion
Remote Computer Account DnsHostName Update,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Active Directory Monitoring,Data Source: Active Directory,Use Case: Vulnerability,Data Source: System",Privilege Escalation
SeDebugPrivilege Enabled by a Suspicious Process,eql,"windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: System",Privilege Escalation
UAC Bypass Attempt with IEditionUpgradeManager Elevated COM Interface,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion; Execution
UAC Bypass Attempt via Elevated COM Internet Explorer Add-On Installer,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion; Execution
UAC Bypass via ICMLuaUtil Elevated COM Interface,eql,"endpoint,windows,m365_defender",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint",Privilege Escalation; Defense Evasion; Execution
UAC Bypass via DiskCleanup Scheduled Task Hijack,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Privilege Escalation; Defense Evasion; Execution
UAC Bypass Attempt via Privileged IFileOperation COM Interface,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion
Bypass UAC via Event Viewer,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: System,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Privilege Escalation; Defense Evasion
UAC Bypass Attempt via Windows Directory Masquerading,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Privilege Escalation; Defense Evasion
UAC Bypass via Windows Firewall Snap-In Hijack,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Tactic: Defense Evasion,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion
Potential Exploitation of an Unquoted Service Path Vulnerability,eql,"endpoint,m365_defender,sentinel_one_cloud_funnel,windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne,Data Source: Elastic Endgame,Data Source: Sysmon,Data Source: System",Privilege Escalation
Unusual Parent-Child Relationship,eql,"endpoint,windows,system,m365_defender,sentinel_one_cloud_funnel,crowdstrike",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: System,Data Source: Microsoft Defender for Endpoint,Data Source: Sysmon,Data Source: SentinelOne,Data Source: Crowdstrike",Privilege Escalation
Unusual Print Spooler Child Process,eql,"endpoint,windows,system",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Use Case: Vulnerability,Data Source: Elastic Defend,Data Source: System",Privilege Escalation
Unusual Service Host Child Process - Childless Service,eql,"endpoint,windows,m365_defender,sentinel_one_cloud_funnel",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Privilege Escalation,Data Source: Elastic Endgame,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Microsoft Defender for Endpoint,Data Source: SentinelOne",Privilege Escalation; Defense Evasion
Privileges Elevation via Parent Process PID Spoofing,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Privilege Escalation via Rogue Named Pipe Impersonation,eql,windows,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Sysmon",Privilege Escalation
Process Created with an Elevated Token,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Windows Service Installed via an Unusual Client,eql,"system,windows",rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: System",Privilege Escalation
WPAD Service Exploit,eql,endpoint,rules/windows,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Privilege Escalation,Data Source: Elastic Defend",Privilege Escalation
Web Application Suspicious Activity: No User Agent,kuery,N/A,rules/_deprecated,"Elastic,APM",N/A
Suspicious Network Connection Attempt by Root,eql,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control",Command and Control; Privilege Escalation
DNS Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Network,Threat Detection,Command and Control,Host",Command and Control
FTP (File Transfer Protocol) Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control; Exfiltration
IRC (Internet Relay Chat) Protocol Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control; Exfiltration
Deprecated - Potential DNS Tunneling via Iodine,kuery,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Endgame,Data Source: Elastic Defend",Command and Control
Potential Linux Reverse Connection through Port Knocking,eql,"endpoint,network_traffic",rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Rule Type: BBR",Command and Control; Defense Evasion
TCP Port 8000 Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
PPTP (Point to Point Tunneling Protocol) Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
Proxy Port Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
SMTP to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control; Exfiltration
SQL Traffic to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
SSH (Secure Shell) from the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control; Lateral Movement; Initial Access
SSH (Secure Shell) to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
Tor Activity to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Command and Control",Command and Control
Potential SSH Brute Force Detected on Privileged Account,eql,system,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Credential Access",Credential Access; Lateral Movement
Network Sniffing via Tcpdump,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Credential Access",Credential Access; Discovery
Attempt to Disable IPTables or Firewall,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Defense Evasion",Defense Evasion
Base64 Encoding/Decoding Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Defense Evasion",Defense Evasion
Suspicious Process from Conhost,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Defense Evasion",Defense Evasion
Trusted Developer Application Usage,kuery,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Defense Evasion",Defense Evasion; Execution
Hex Encoding/Decoding Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Defense Evasion",Defense Evasion
Deprecated - Potential Process Injection via LD_PRELOAD Environment Variable,eql,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Tactic: Privilege Escalation,Data Source: Elastic Defend",Defense Evasion; Persistence; Privilege Escalation
Network Connection via Mshta,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Defense Evasion",Defense Evasion
Potential Process Herpaderping Attempt,eql,"endpoint,windows",rules/_deprecated,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend",Defense Evasion
Whitespace Padding in Process Command Line,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Defense Evasion",Defense Evasion
File and Directory Discovery,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Discovery",Discovery
Process Discovery via Tasklist,kuery,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Discovery",Discovery
Query Registry via reg.exe,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Discovery",Discovery
User Discovery via Whoami,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Discovery",Discovery
Linux Restricted Shell Breakout via  apt/apt-get Changelog Escape,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via awk Commands,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via busybox Shell Evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via c89/c99 Shell evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
PowerShell spawning Cmd,kuery,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Execution",Execution
Linux Restricted Shell Breakout via cpulimit Shell Evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via crash Shell evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via env Shell Evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via the expect command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via the find command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via flock Shell evasion,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Linux Restricted Shell Breakout via the gcc command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Unusual Process Execution - Temp,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution",Execution
Linux Restricted Shell Breakout via the mysql command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Reverse Shell Created via Named Pipe,eql,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Endgame",Execution
Deprecated - Potential Reverse Shell via Suspicious Parent Process,eql,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend",Execution; Command and Control
Linux Restricted Shell Breakout via the SSH command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Execution via Regsvcs/Regasm,kuery,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Execution",Execution; Defense Evasion
Linux Restricted Shell Breakout via the vi command,eql,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Execution,GTFOBins",Execution
Suspicious File Changes Activity Detected,eql,endpoint,rules/_deprecated,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Impact,Data Source: Elastic Defend",Impact
Auditd Max Failed Login Attempts,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Initial Access",Initial Access; Persistence
Auditd Login from Forbidden Location,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Initial Access",Initial Access; Persistence
Auditd Max Login Sessions,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Initial Access",Initial Access; Persistence
Auditd Login Attempt at Forbidden Time,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Initial Access",Initial Access; Persistence
RDP (Remote Desktop Protocol) to the Internet,kuery,N/A,rules/_deprecated,"Elastic,Host,Network,Threat Detection,Initial Access",Initial Access; Exfiltration
Malicious Remote File Creation,eql,endpoint,rules/_deprecated,"Domain: Endpoint,Use Case: Lateral Movement Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Deprecated - Remote File Creation on a Sensitive Directory,eql,endpoint,rules/_deprecated,"Domain: Endpoint,Use Case: Lateral Movement Detection,Tactic: Lateral Movement,Data Source: Elastic Defend",Lateral Movement
Mknod Process Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection",N/A
Nmap Process Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection",N/A
Socat Process Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection",N/A
Potential Persistence via Cron Job,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,macOS,Threat Detection,Persistence",Persistence
Google Workspace User Group Access Modified to Allow External Access,kuery,google_workspace,rules/_deprecated,"Elastic,Cloud,Google Workspace,Continuous Monitoring,SecOps,Identity and Access,Persistence",Persistence
Persistence via Kernel Module Modification,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Persistence",Persistence
Potential Shell via Web Server,kuery,endpoint,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Persistence,Investigation Guide,Elastic Endgame",Persistence
GCP Kubernetes Rolebindings Created or Patched,kuery,"g,c,p",rules/_deprecated,"Elastic,Cloud,GCP,Continuous Monitoring,SecOps,Configuration Audit",Privilege Escalation
Potential Privilege Escalation via Local Kerberos Relay over LDAP,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Privilege Escalation,Credential Access",Privilege Escalation; Credential Access
Strace Process Activity,kuery,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Privilege Escalation",Privilege Escalation
Potential PrintNightmare File Modification,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Privilege Escalation",Privilege Escalation
Potential PrintNightmare Exploit Registry Modification,eql,N/A,rules/_deprecated,"Elastic,Host,Windows,Threat Detection,Privilege Escalation",Privilege Escalation
Setgid Bit Set via chmod,lucene,N/A,rules/_deprecated,"Elastic,Host,Linux,Threat Detection,Privilege Escalation",Privilege Escalation; Persistence
Threat Intel Filebeat Module (v7.x) Indicator Match,kuery,N/A,rules/_deprecated,"Elastic,Windows,Elastic Endgame,Network,Continuous Monitoring,SecOps,Monitoring",N/A
Deprecated - Threat Intel Filebeat Module (v8.x) Indicator Match,kuery,N/A,rules/_deprecated,"OS: Windows,Data Source: Elastic Endgame,Resources: Investigation Guide",N/A
Deprecated - Threat Intel Indicator Match,kuery,N/A,rules/_deprecated,"OS: Windows,Data Source: Elastic Endgame,Resources: Investigation Guide",N/A
Compression DLL Loaded by Unusual Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: Elastic Defend,Rule Type: BBR",Collection
File Compressed or Archived into Common Format,eql,"e,n,d,p,o,i,n,t",rules_building_block,"Data Source: Elastic Defend,Domain: Endpoint,OS: macOS,OS: Windows,Tactic: Collection,Rule Type: BBR",Collection; Command and Control; Defense Evasion
File Staged in Root Folder of Recycle Bin,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: Sysmon",Collection
Accessing Outlook Data Files,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Collection
Bitsadmin Activity,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Command and Control; Defense Evasion; Persistence
Network Connection via Certutil,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Command and Control,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Sysmon,Data Source: Elastic Endgame,Rule Type: BBR",Command and Control
Potential Non-Standard Port HTTP/HTTPS connection,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Command and Control,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame",Command and Control
Microsoft IIS Service Account Password Dumped,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR,Data Source: System",Credential Access
Potential Credential Access via Memory Dump File Creation,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Rule Type: BBR",Credential Access
Memory Dump File with Unusual Extension,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR",Credential Access; Defense Evasion
Attempted Private Key Access,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Credential Access,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Credential Access
AWS RDS DB Snapshot Created,kuery,aws,rules_building_block,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS RDS,Use Case: Asset Visibility,Tactic: Defense Evasion,Rule Type: BBR",Defense Evasion
Binary Content Copy via Cmd.exe,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Defense Evasion; Execution
Potential Defense Evasion via CMSTP.exe,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Defense Evasion
Archive File with Unusual Extension,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR",Defense Evasion
Suspicious Communication App Child Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion; Persistence
Unsigned DLL Loaded by a Trusted Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
Execution via Microsoft DotNet ClickOnce Host,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
File with Suspicious Extension Downloaded,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR",Defense Evasion; Initial Access
Execution via MS VisualStudio Pre/Post Build Events,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Execution,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion; Execution
File and Directory Permissions Modification,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
File or Directory Deletion Command,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
Indirect Command Execution via Forfiles/Pcalua,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Defense Evasion
Potential Process Injection from Malicious Document,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Privilege Escalation,Tactic: Initial Access,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion; Privilege Escalation; Initial Access
InstallUtil Activity,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Defense Evasion
Image Loaded with Invalid Signature,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
Potential Masquerading as Browser Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion; Persistence
Executable File with Unusual Extension,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
Potential Masquerading as VLC DLL,eql,endpoint,rules_building_block,"Domain: Endpoint,Data Source: Elastic Defend,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Rule Type: BBR",Defense Evasion; Persistence
Potential Masquerading as System32 DLL,eql,endpoint,rules_building_block,"Domain: Endpoint,Data Source: Elastic Defend,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Rule Type: BBR",Defense Evasion; Persistence
Potential Masquerading as System32 Executable,eql,endpoint,rules_building_block,"Domain: Endpoint,Data Source: Elastic Defend,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Tactic: Persistence,Rule Type: BBR",Defense Evasion; Persistence
Suspicious Troubleshooting Pack Cabinet Execution,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: System",Defense Evasion
Windows Installer with Suspicious Properties,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
PowerShell Script with Windows Defender Tampering Capabilities,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: PowerShell Logs,Rule Type: BBR",Defense Evasion; Execution
PowerShell Script with Log Clear Capabilities,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: PowerShell Logs,Rule Type: BBR",Defense Evasion; Execution
Processes with Trailing Spaces,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Defense Evasion
Service Path Modification via sc.exe,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: System",Defense Evasion; Persistence; Privilege Escalation
Service Disabled via Registry Modification,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR",Defense Evasion; Impact
Service Path Modification,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon",Defense Evasion; Persistence; Privilege Escalation
Suspicious Execution via MSIEXEC,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame",Defense Evasion
Unsigned BITS Service Client Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Defense Evasion
Unusual Process Extension,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR",Defense Evasion
Unusual Process Execution on WBEM Path,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Defense Evasion
WRITEDAC Access on Active Directory Object,kuery,"system,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Defense Evasion,Data Source: Active Directory,Use Case: Active Directory Monitoring,Rule Type: BBR,Data Source: System",Defense Evasion
Network Traffic Capture via CAP_NET_RAW,kuery,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Rule Type: BBR",Discovery
System Information Discovery via Windows Command Shell,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Execution,Resources: Investigation Guide,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Discovery; Execution
Windows Account or Group Discovery,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend",Discovery
Process Discovery Using Built-in Tools,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: System",Discovery
Query Registry using Built-in Tools,kuery,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend",Discovery
System Hosts File Access,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
Discovery of Internet Capabilities via Built-in Tools,kuery,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend",Discovery
Enumeration of Kernel Modules via Proc,kuery,auditd_manager,rules_building_block,"Data Source: Auditd Manager,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR",Discovery
Suspicious Modprobe File Event,kuery,auditd_manager,rules_building_block,"Data Source: Auditd Manager,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR",Discovery
Suspicious Sysctl File Event,kuery,auditd_manager,rules_building_block,"Data Source: Auditd Manager,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR",Discovery
Linux System Information Discovery,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
System Owner/User Discovery Linux,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
Potential Network Share Discovery,eql,"windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Collection,Rule Type: BBR,Data Source: System",Discovery; Collection
Windows Network Enumeration,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Collection,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR",Discovery; Collection
Account or Group Discovery via Built-In Tools,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
Discovery of Domain Groups,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
PowerShell Script with Discovery Capabilities,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Collection,Tactic: Discovery,Data Source: PowerShell Logs,Rule Type: BBR",Discovery; Execution
PowerShell Script with Password Policy Discovery Capabilities,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Tactic: Execution,Data Source: PowerShell Logs,Rule Type: BBR",Discovery; Execution
External IP Lookup from Non-Browser Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Defend,Rule Type: BBR",Discovery
Potential Memory Seeking Activity,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Process Discovery via Built-In Applications,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame",Discovery
Remote System Discovery Commands,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Defend,Data Source: Elastic Endgame,Rule Type: BBR",Discovery
Security Software Discovery using WMIC,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Resources: Investigation Guide,Data Source: Elastic Endgame,Data Source: Elastic Defend,Rule Type: BBR,Data Source: System",Discovery; Execution
Unusual Discovery Activity by User,kuery,N/A,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: Higher-Order Rule,Rule Type: BBR",Discovery
Suspicious Proc Pseudo File System Enumeration,kuery,auditd_manager,rules_building_block,"Data Source: Auditd Manager,OS: Linux,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR",Discovery
System Network Connections Discovery,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Discovery
System Service Discovery through built-in Windows Utilities,eql,"windows,endpoint,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Rule Type: BBR,Data Source: System",Discovery
System Time Discovery,eql,"windows,endpoint,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Data Source: Elastic Defend,Data Source: Elastic Endgame,Rule Type: BBR,Data Source: System",Discovery
Attempt to Retrieve User Data from AWS EC2 Instance,kuery,aws,rules_building_block,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: Amazon EC2,Use Case: Log Auditing,Tactic: Discovery,Rule Type: BBR",Discovery
Windows System Information Discovery,eql,"windows,endpoint,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: System",Discovery
Windows System Network Connections Discovery,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Discovery,Rule Type: BBR,Data Source: Elastic Defend",Discovery
AWS Lambda Function Created or Updated,kuery,aws,rules_building_block,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS Lambda,Use Case: Asset Visibility,Tactic: Execution,Rule Type: BBR",Execution
First Occurrence GitHub Event for a Personal Access Token (PAT),kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: BBR,Data Source: Github",Execution
First Occurrence of Private Repo Event from Specific GitHub Personal Access Token (PAT),kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: BBR,Data Source: Github",Execution
First Occurrence of GitHub User Interaction with Private Repo,kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: BBR,Data Source: Github",Execution
GitHub Repo Created,eql,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: BBR,Data Source: Github",Execution
First Occurrence of GitHub Repo Interaction From a New IP,kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Execution,Rule Type: BBR,Data Source: Github",Execution
Segfault Detected,kuery,system,rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Execution,Rule Type: BBR",Execution
Creation of SettingContent-ms Files,eql,"endpoint,windows",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame",Execution; Initial Access
Execution of an Unsigned Service,kuery,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Tactic: Defense Evasion,Rule Type: BBR,Data Source: Elastic Defend",Execution; Defense Evasion
WMI WBEMTEST Utility Execution,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Execution,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Execution
Member Removed From GitHub Organization,eql,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Impact,Rule Type: BBR,Data Source: Github",Impact
GitHub PAT Access Revoked,eql,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Impact,Rule Type: BBR,Data Source: Github",Impact
GitHub User Blocked From Organization,eql,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Impact,Rule Type: BBR,Data Source: Github",Impact
Potential Cross Site Scripting (XSS),eql,apm,rules_building_block,"Data Source: APM,Use Case: Threat Detection,Tactic: Initial Access,Rule Type: BBR",Initial Access
First Occurrence of IP Address For GitHub Personal Access Token (PAT),kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Initial Access,Rule Type: BBR,Data Source: Github",Initial Access
First Occurrence of IP Address For GitHub User,kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Initial Access,Rule Type: BBR,Data Source: Github",Initial Access
First Occurrence of User Agent For a GitHub Personal Access Token (PAT),kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Initial Access,Rule Type: BBR,Data Source: Github",Initial Access
First Occurrence of User-Agent For a GitHub User,kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Initial Access,Rule Type: BBR,Data Source: Github",Initial Access
At.exe Command Lateral Movement,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Elastic Endgame,Data Source: System",Lateral Movement; Execution
PowerShell Script with Remote Execution Capabilities via WinRM,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Execution,Data Source: PowerShell Logs,Rule Type: BBR",Lateral Movement; Execution
Potential Outgoing RDP Connection by Unusual Process,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Rule Type: BBR",Lateral Movement
Unusual Process For MSSQL Service Accounts,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Tactic: Persistence,Data Source: Elastic Defend,Rule Type: BBR",Lateral Movement; Persistence
WMIC Remote Command,eql,"endpoint,windows,system",rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Lateral Movement,Data Source: Elastic Defend,Rule Type: BBR,Data Source: Sysmon,Data Source: Elastic Endgame,Data Source: System",Lateral Movement; Execution
AWS IAM Login Profile Added to User,kuery,aws,rules_building_block,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Persistence,Rule Type: BBR",Persistence
CAP_SYS_ADMIN Assigned to Binary,kuery,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Rule Type: BBR",Persistence
Creation of Kernel Module,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Linux,Use Case: Threat Detection,Tactic: Persistence,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame",Persistence
First Occurrence of Personal Access Token (PAT) Use For a GitHub User,kuery,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Persistence,Rule Type: BBR,Data Source: Github",Persistence
New User Added To GitHub Organization,eql,github,rules_building_block,"Domain: Cloud,Use Case: Threat Detection,Use Case: UEBA,Tactic: Persistence,Rule Type: BBR,Data Source: Github",Persistence
AWS EC2 Instance Interaction with IAM Service,eql,aws,rules_building_block,"Domain: Cloud,Data Source: AWS,Data Source: Amazon Web Services,Data Source: AWS EC2,Data Source: AWS IAM,Use Case: Identity and Access Audit,Tactic: Privilege Escalation,Tactic: Persistence,Rule Type: BBR",Persistence; Privilege Escalation
Shortcut File Written or Modified on Startup Folder,eql,endpoint,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: Elastic Defend,Rule Type: BBR",Persistence
Microsoft Exchange Transport Agent Install Script,kuery,windows,rules_building_block,"Domain: Endpoint,OS: Windows,Use Case: Threat Detection,Tactic: Persistence,Data Source: PowerShell Logs,Rule Type: BBR",Persistence; Execution
Trap Signals Execution,eql,"endpoint,auditd_manager",rules_building_block,"Domain: Endpoint,OS: Linux,OS: macOS,Use Case: Threat Detection,Tactic: Privilege Escalation,Rule Type: BBR,Data Source: Elastic Defend,Data Source: Elastic Endgame,Data Source: Auditd Manager",Privilege Escalation
